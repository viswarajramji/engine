2024-08-06 09:42:45.262322+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "GPS_REAL_TIME_TRANSACTIONS" not found; SQL statement:
SELECT
    g.CustomerID AS G_CustomerID,
    g.CarID AS G_CarID,
    g.OfficeID AS G_OfficeID,
    g.AgentID AS G_AgentID,
    g.TRXN_Timestamp AS G_TRXN_Timestamp,
    g.CarDrivingStatus AS G_CarDrivingStatus,
    g.CurrentLongitude AS G_CurrentLongitude,
    g.CurrentLatitude AS G_CurrentLatitude,
    g.CurrentArea AS G_CurrentArea,
    g.KM AS G_KM,
    s.AgentID AS S_AgentID,
    s.OfficeID AS S_OfficeID,
    s.CarID AS S_CarID,
    s.CustomerID AS S_CustomerID,
    s.Amount AS S_Amount,
    c.Mobile_No AS C_Mobile_No,
    c.Name AS C_Name,
    c.Gender AS C_Gender,
    c.Age AS C_Age,
    c.Nationality AS C_Nationality,
    c.PassportNo AS C_PassportNo,
    c.ID_No AS C_ID_No,
    c.Home_Address AS C_Home_Address,
    c.Lease_Start_Date AS C_Lease_Start_Date,
    c.Lease_Period AS C_Lease_Period,
    car.Car_Make AS Car_Car_Make,
    car.Car_Model AS Car_Car_Model,
    car.Plate_No AS Car_Plate_No,
    car.Registration_Date AS Car_Registration_Date,
    car.Registration_Expiry_Date AS Car_Registration_Expiry_Date,
    o.Mobile_No AS O_Mobile_No,
    o.Area AS O_Area,
    o.Office_No AS O_Office_No,
    o.Working_Hours AS O_Working_Hours,
    a.Mobile_No AS A_Mobile_No,
    a.Name AS A_Name,
    a.Gender AS A_Gender,
    a.Age AS A_Age,
    a.Nationality AS A_Nationality
FROM
    GPS_Real_Time_Transactions g
LEFT JOIN
    Sales_Transactions s ON g.CustomerID = s.CustomerID AND g.CarID = s.CarID AND g.OfficeID = s.OfficeID AND g.AgentID = s.AgentID
LEFT JOIN
    Customer_Data c ON g.CustomerID = c.CustomerID
LEFT JOIN
    Car_Data car ON g.CarID = car.CarID
LEFT JOIN
    Office_Branch_Data o ON g.OfficeID = o.OfficeID
LEFT JOIN
    Sales_Agent_Data a ON g.AgentID = a.AgentID [42102-224]
2024-08-06 09:43:06.797747+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "GPS__TRANSACTIONS" not found; SQL statement:
SELECT
    g.CustomerID AS G_CustomerID,
    g.CarID AS G_CarID,
    g.OfficeID AS G_OfficeID,
    g.AgentID AS G_AgentID,
    g.TRXN_Timestamp AS G_TRXN_Timestamp,
    g.CarDrivingStatus AS G_CarDrivingStatus,
    g.CurrentLongitude AS G_CurrentLongitude,
    g.CurrentLatitude AS G_CurrentLatitude,
    g.CurrentArea AS G_CurrentArea,
    g.KM AS G_KM,
    s.AgentID AS S_AgentID,
    s.OfficeID AS S_OfficeID,
    s.CarID AS S_CarID,
    s.CustomerID AS S_CustomerID,
    s.Amount AS S_Amount,
    c.Mobile_No AS C_Mobile_No,
    c.Name AS C_Name,
    c.Gender AS C_Gender,
    c.Age AS C_Age,
    c.Nationality AS C_Nationality,
    c.PassportNo AS C_PassportNo,
    c.ID_No AS C_ID_No,
    c.Home_Address AS C_Home_Address,
    c.Lease_Start_Date AS C_Lease_Start_Date,
    c.Lease_Period AS C_Lease_Period,
    car.Car_Make AS Car_Car_Make,
    car.Car_Model AS Car_Car_Model,
    car.Plate_No AS Car_Plate_No,
    car.Registration_Date AS Car_Registration_Date,
    car.Registration_Expiry_Date AS Car_Registration_Expiry_Date,
    o.Mobile_No AS O_Mobile_No,
    o.Area AS O_Area,
    o.Office_No AS O_Office_No,
    o.Working_Hours AS O_Working_Hours,
    a.Mobile_No AS A_Mobile_No,
    a.Name AS A_Name,
    a.Gender AS A_Gender,
    a.Age AS A_Age,
    a.Nationality AS A_Nationality
FROM
    GPS__TRANSACTIONS g
LEFT JOIN
    Sales_Transactions s ON g.CustomerID = s.CustomerID AND g.CarID = s.CarID AND g.OfficeID = s.OfficeID AND g.AgentID = s.AgentID
LEFT JOIN
    Customer_Data c ON g.CustomerID = c.CustomerID
LEFT JOIN
    Car_Data car ON g.CarID = car.CarID
LEFT JOIN
    Office_Branch_Data o ON g.OfficeID = o.OfficeID
LEFT JOIN
    Sales_Agent_Data a ON g.AgentID = a.AgentID [42102-224]
2024-08-06 09:43:11.623106+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "G.CUSTOMERID" not found; SQL statement:
SELECT
    g.CustomerID AS G_CustomerID,
    g.CarID AS G_CarID,
    g.OfficeID AS G_OfficeID,
    g.AgentID AS G_AgentID,
    g.TRXN_Timestamp AS G_TRXN_Timestamp,
    g.CarDrivingStatus AS G_CarDrivingStatus,
    g.CurrentLongitude AS G_CurrentLongitude,
    g.CurrentLatitude AS G_CurrentLatitude,
    g.CurrentArea AS G_CurrentArea,
    g.KM AS G_KM,
    s.AgentID AS S_AgentID,
    s.OfficeID AS S_OfficeID,
    s.CarID AS S_CarID,
    s.CustomerID AS S_CustomerID,
    s.Amount AS S_Amount,
    c.Mobile_No AS C_Mobile_No,
    c.Name AS C_Name,
    c.Gender AS C_Gender,
    c.Age AS C_Age,
    c.Nationality AS C_Nationality,
    c.PassportNo AS C_PassportNo,
    c.ID_No AS C_ID_No,
    c.Home_Address AS C_Home_Address,
    c.Lease_Start_Date AS C_Lease_Start_Date,
    c.Lease_Period AS C_Lease_Period,
    car.Car_Make AS Car_Car_Make,
    car.Car_Model AS Car_Car_Model,
    car.Plate_No AS Car_Plate_No,
    car.Registration_Date AS Car_Registration_Date,
    car.Registration_Expiry_Date AS Car_Registration_Expiry_Date,
    o.Mobile_No AS O_Mobile_No,
    o.Area AS O_Area,
    o.Office_No AS O_Office_No,
    o.Working_Hours AS O_Working_Hours,
    a.Mobile_No AS A_Mobile_No,
    a.Name AS A_Name,
    a.Gender AS A_Gender,
    a.Age AS A_Age,
    a.Nationality AS A_Nationality
FROM
    GPS_TRANSACTIONS g
LEFT JOIN
    Sales_Transactions s ON g.CustomerID = s.CustomerID AND g.CarID = s.CarID AND g.OfficeID = s.OfficeID AND g.AgentID = s.AgentID
LEFT JOIN
    Customer_Data c ON g.CustomerID = c.CustomerID
LEFT JOIN
    Car_Data car ON g.CarID = car.CarID
LEFT JOIN
    Office_Branch_Data o ON g.OfficeID = o.OfficeID
LEFT JOIN
    Sales_Agent_Data a ON g.AgentID = a.AgentID [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.Alias.optimize(Alias.java:52)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 09:45:18.800035+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "C.PASSPORTNO" not found; SQL statement:
SELECT
    g.Customer_ID AS G_CustomerID,
    g.Car_ID AS G_CarID,
    g.Office_ID AS G_OfficeID,
    g.Agent_ID AS G_AgentID,
    g.TRXN_Timestamp AS G_TRXN_Timestamp,
    g.Car_Driving_Status AS G_CarDrivingStatus,
    g.Current_Longitude AS G_CurrentLongitude,
    g.Current_Latitude AS G_CurrentLatitude,
    g.Current_Area AS G_CurrentArea,
    g.KM AS G_KM,
    s.Agent_ID AS S_AgentID,
    s.Office_ID AS S_OfficeID,
    s.Car_ID AS S_CarID,
    s.Customer_ID AS S_CustomerID,
    s.Amount AS S_Amount,
    c.Mobile_No AS C_Mobile_No,
    c.Name AS C_Name,
    c.Gender AS C_Gender,
    c.Age AS C_Age,
    c.Nationality AS C_Nationality,
    c.PassportNo AS C_PassportNo,
    c.ID_No AS C_ID_No,
    c.Home_Address AS C_Home_Address,
    c.Lease_Start_Date AS C_Lease_Start_Date,
    c.Lease_Period AS C_Lease_Period,
    car.Car_Make AS Car_Car_Make,
    car.Car_Model AS Car_Car_Model,
    car.Plate_No AS Car_Plate_No,
    car.Registration_Date AS Car_Registration_Date,
    car.Registration_Expiry_Date AS Car_Registration_Expiry_Date,
    o.Mobile_No AS O_Mobile_No,
    o.Area AS O_Area,
    o.Office_No AS O_Office_No,
    o.Working_Hours AS O_Working_Hours,
    a.Mobile_No AS A_Mobile_No,
    a.Name AS A_Name,
    a.Gender AS A_Gender,
    a.Age AS A_Age,
    a.Nationality AS A_Nationality
FROM
    GPS_TRANSACTIONS g
LEFT JOIN
    Sales_Transactions s ON g.Customer_ID = s.Customer_ID AND g.Car_ID = s.Car_ID AND g.Office_ID = s.Office_ID AND g.Agent_ID = s.Agent_ID
LEFT JOIN
    Customer_Data c ON g.Customer_ID = c.Customer_ID
LEFT JOIN
    Car_Data car ON g.Car_ID = car.Car_ID
LEFT JOIN
    Office_Branch_Data o ON g.Office_ID = o.Office_ID
LEFT JOIN
    Sales_Agent_Data a ON g.Agent_ID = a.Agent_ID [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.Alias.optimize(Alias.java:52)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 09:47:52.469860+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "GPS_TRANCUSTOMER_DATA" not found; SQL statement:
SELECT * FROM GPS_TRANCUSTOMER_DATA SACTIONS [42102-224]
2024-08-06 09:47:53.435517+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "GPS_TRANCUSTOMER_DATA" not found; SQL statement:
SELECT * FROM GPS_TRANCUSTOMER_DATA SACTIONS [42102-224]
2024-08-06 09:47:57.318246+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "GPS_TRANCUSTOMER_DATA" not found; SQL statement:
SELECT * FROM GPS_TRANCUSTOMER_DATA [42102-224]
2024-08-06 09:52:56.659346+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT * \000d\000a[*]10\000d\000a10FROM \000d\000a10\000d\000a10GPS_TRANSACTIONS g"; SQL statement:
SELECT * 
10
10FROM 
10
10GPS_TRANSACTIONS g [42000-224]
2024-08-06 09:53:12.078273+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT * \000d\000a[*]10\000d\000a10FROM \000d\000a10\000d\000a10GPS_TRANSACTIONS gps"; SQL statement:
SELECT * 
10
10FROM 
10
10GPS_TRANSACTIONS gps [42000-224]
2024-08-06 09:55:53.076061+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "[*]GPS_TRANSACTIONS"; expected "GRANT"; SQL statement:
GPS_TRANSACTIONS [42001-224]
2024-08-06 10:08:12.622654+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a*\000d\000a\000d\000aFROM \000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,\000d\000a[*]JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; expected "identifier"; SQL statement:
SELECT 
*

FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42001-224]
2024-08-06 10:08:46.434163+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "GPS.CA_RID" not found; SQL statement:
SELECT 
*
FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID 
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.condition.Comparison.optimize(Comparison.java:148)
	at org.h2.expression.condition.ConditionAndOrN.optimize(ConditionAndOrN.java:168)
	at org.h2.expression.condition.ConditionAndOr.optimize(ConditionAndOr.java:136)
	at org.h2.expression.Expression.optimizeCondition(Expression.java:148)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1177)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 10:08:47.769206+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "GPS.CA_RID" not found; SQL statement:
SELECT 
*
FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID 
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.condition.Comparison.optimize(Comparison.java:148)
	at org.h2.expression.condition.ConditionAndOrN.optimize(ConditionAndOrN.java:168)
	at org.h2.expression.condition.ConditionAndOr.optimize(ConditionAndOr.java:136)
	at org.h2.expression.Expression.optimizeCondition(Expression.java:148)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1177)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 10:09:10.388497+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "[*]JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; SQL statement:
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42000-224]
2024-08-06 10:20:07.540474+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a gps.TRXN_Timestamp AS TRXN_Timestamp,\000d\000a gps.Car_Driving_Status AS Car_Driving_Status,\000d\000a gps.Current_Longitude AS Current_Longitude,\000d\000a gps.Current_Latitude AS Current_Latitude,\000d\000a gps.Current_Area AS Current_Area,\000d\000a gps.KM AS KM,\000d\000a st.Amount AS Amount,\000d\000a cd .Mobile_No ASCustomer_ [*]Mobile_Number,\000d\000a  cd .Name AS Customer_Name,\000d\000a\000d\000a   cd.Gender AS Customer_Gender,\000d\000a    cd.Age AS Customer_Age,\000d\000a    cd.Nationality AS Customer_Nationality,\000d\000a    cd.Passport_No AS Customer_PassportNo,\000d\000a    cd.ID_No AS Customer_Id_No,\000d\000a    cd.Home_Address AS Customer_Home_address,\000d\000a    cd.Lease_Start_Date AS Customer_Lease_Start_Date ,\000d\000a    cd.Lease_Period AS Customer_Lease_Period ,\000d\000a\000d\000a    car.Car_Make AS Car_Make,\000d\000a    car.Car_Model AS Car_Model,\000d\000a    car.Plate_No AS Car_Plate_No,\000d\000a    car.Registration_Date AS Car_Registration_Date,\000d\000a    car.Registration_Expiry_Date AS Car_Registration_Expiry_Date,\000d\000a    obd.Mobile_No AS Office_Mobile_No,\000d\000a    obd.Area AS Office_Area,\000d\000a    obd.Office_No AS Office_Office_No,\000d\000a    obd.Working_Hours AS Office_Working_Hours,\000d\000a    sgd.Mobile_No AS Agent_Mobile_No,\000d\000a    sgd.Name AS Agent_Name,\000d\000a    sgd.Gender AS Agent_Gender,\000d\000a    sgd.Age AS Agent_Age,\000d\000a    sgd.Nationality AS Agent_Nationality\000d\000a\000d\000aFROM \000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,\000d\000aJOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; SQL statement:
SELECT 
 gps.TRXN_Timestamp AS TRXN_Timestamp,
 gps.Car_Driving_Status AS Car_Driving_Status,
 gps.Current_Longitude AS Current_Longitude,
 gps.Current_Latitude AS Current_Latitude,
 gps.Current_Area AS Current_Area,
 gps.KM AS KM,
 st.Amount AS Amount,
 cd .Mobile_No ASCustomer_ Mobile_Number,
  cd .Name AS Customer_Name,

   cd.Gender AS Customer_Gender,
    cd.Age AS Customer_Age,
    cd.Nationality AS Customer_Nationality,
    cd.Passport_No AS Customer_PassportNo,
    cd.ID_No AS Customer_Id_No,
    cd.Home_Address AS Customer_Home_address,
    cd.Lease_Start_Date AS Customer_Lease_Start_Date ,
    cd.Lease_Period AS Customer_Lease_Period ,

    car.Car_Make AS Car_Make,
    car.Car_Model AS Car_Model,
    car.Plate_No AS Car_Plate_No,
    car.Registration_Date AS Car_Registration_Date,
    car.Registration_Expiry_Date AS Car_Registration_Expiry_Date,
    obd.Mobile_No AS Office_Mobile_No,
    obd.Area AS Office_Area,
    obd.Office_No AS Office_Office_No,
    obd.Working_Hours AS Office_Working_Hours,
    sgd.Mobile_No AS Agent_Mobile_No,
    sgd.Name AS Agent_Name,
    sgd.Gender AS Agent_Gender,
    sgd.Age AS Agent_Age,
    sgd.Nationality AS Agent_Nationality

FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42000-224]
2024-08-06 10:23:14.784095+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select * \000d\000a\000d\000afrom\000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,\000d\000a[*]JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; expected "identifier"; SQL statement:
select * 

from

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42001-224]
2024-08-06 10:23:26.320924+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select * \000d\000a\000d\000afrom\000d\000aGPS_TRANSACTIONS gps\000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,\000d\000a[*]JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; expected "identifier"; SQL statement:
select * 

from
GPS_TRANSACTIONS gps
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42001-224]
2024-08-06 10:23:33.686722+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select \000d\000a\000d\000a*\000d\000a\000d\000afrom\000d\000aGPS_TRANSACTIONS gps\000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,\000d\000a[*]JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; expected "identifier"; SQL statement:
select 

*

from
GPS_TRANSACTIONS gps
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID,
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Ca_rID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42001-224]
2024-08-06 10:24:19.848394+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000agps.TRXN_Timestamp AS TRXN_Timestamp,\000d\000a gps.Car_Driving_Status AS Car_Driving_Status,\000d\000a gps.Current_Longitude AS Current_Longitude,\000d\000a gps.Current_Latitude AS Current_Latitude,\000d\000a gps.Current_Area AS Current_Area,\000d\000a gps.KM AS KM,\000d\000a\000d\000ast.Amount AS Amount,\000d\000a cd .Mobile_No ASCustomer_ [*]Mobile_Number,\000d\000a  cd .Name AS Customer_Name,\000d\000a\000d\000a   cd.Gender AS Customer_Gender,\000d\000a    cd.Age AS Customer_Age,\000d\000a    cd.Nationality AS Customer_Nationality,\000d\000a    cd.Passport_No AS Customer_PassportNo,\000d\000a    cd.ID_No AS Customer_Id_No,\000d\000a    cd.Home_Address AS Customer_Home_address,\000d\000a    cd.Lease_Start_Date AS Customer_Lease_Start_Date ,\000d\000a    cd.Lease_Period AS Customer_Lease_Period \000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000aFROM \000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID \000d\000aJOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; SQL statement:
SELECT 
gps.TRXN_Timestamp AS TRXN_Timestamp,
 gps.Car_Driving_Status AS Car_Driving_Status,
 gps.Current_Longitude AS Current_Longitude,
 gps.Current_Latitude AS Current_Latitude,
 gps.Current_Area AS Current_Area,
 gps.KM AS KM,

st.Amount AS Amount,
 cd .Mobile_No ASCustomer_ Mobile_Number,
  cd .Name AS Customer_Name,

   cd.Gender AS Customer_Gender,
    cd.Age AS Customer_Age,
    cd.Nationality AS Customer_Nationality,
    cd.Passport_No AS Customer_PassportNo,
    cd.ID_No AS Customer_Id_No,
    cd.Home_Address AS Customer_Home_address,
    cd.Lease_Start_Date AS Customer_Lease_Start_Date ,
    cd.Lease_Period AS Customer_Lease_Period 






FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID 
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42000-224]
2024-08-06 10:24:56.598345+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000agps.TRXN_Timestamp AS TRXN_Timestamp,\000d\000a gps.Car_Driving_Status AS Car_Driving_Status,\000d\000a gps.Current_Longitude AS Current_Longitude,\000d\000a gps.Current_Latitude AS Current_Latitude,\000d\000a gps.Current_Area AS Current_Area,\000d\000a gps.KM AS KM,\000d\000a\000d\000ast.Amount AS Amount,\000d\000acd .Mobile_No AS Customer_ [*]Mobile_Number,\000d\000a d .Name AS Customer_Name,\000d\000a cd.Gender AS Customer_Gender,\000d\000a cd.Age AS Customer_Age,\000d\000a  cd.Nationality AS Customer_Nationality,\000d\000a  cd.Passport_No AS Customer_PassportNo,\000d\000a  cd.ID_No AS Customer_Id_No,\000d\000a  cd.Home_Address AS Customer_Home_address,\000d\000a   cd.Lease_Start_Date AS Customer_Lease_Start_Date ,\000d\000a   cd.Lease_Period AS Customer_Lease_Period \000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000aFROM \000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID \000d\000aJOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; SQL statement:
SELECT 
gps.TRXN_Timestamp AS TRXN_Timestamp,
 gps.Car_Driving_Status AS Car_Driving_Status,
 gps.Current_Longitude AS Current_Longitude,
 gps.Current_Latitude AS Current_Latitude,
 gps.Current_Area AS Current_Area,
 gps.KM AS KM,

st.Amount AS Amount,
cd .Mobile_No AS Customer_ Mobile_Number,
 d .Name AS Customer_Name,
 cd.Gender AS Customer_Gender,
 cd.Age AS Customer_Age,
  cd.Nationality AS Customer_Nationality,
  cd.Passport_No AS Customer_PassportNo,
  cd.ID_No AS Customer_Id_No,
  cd.Home_Address AS Customer_Home_address,
   cd.Lease_Start_Date AS Customer_Lease_Start_Date ,
   cd.Lease_Period AS Customer_Lease_Period 






FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID 
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42000-224]
2024-08-06 10:25:27.282833+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000agps.TRXN_Timestamp AS TRXN_Timestamp,\000d\000a gps.Car_Driving_Status AS Car_Driving_Status,\000d\000a gps.Current_Longitude AS Current_Longitude,\000d\000a gps.Current_Latitude AS Current_Latitude,\000d\000a gps.Current_Area AS Current_Area,\000d\000a gps.KM AS KM,\000d\000a\000d\000ast.Amount AS Amount,\000d\000acd .Mobile_No AS Customer_ [*]Mobile_Number,\000d\000a cd .Name AS Customer_Name,\000d\000a cd.Gender AS Customer_Gender,\000d\000a cd.Age AS Customer_Age,\000d\000a  cd.Nationality AS Customer_Nationality,\000d\000a  cd.Passport_No AS Customer_Passport_No,\000d\000a  cd.ID_No AS Customer_Id_No,\000d\000a  cd.Home_Address AS Customer_Home_address,\000d\000a   cd.Lease_Start_Date AS Customer_Lease_Start_Date ,\000d\000a   cd.Lease_Period AS Customer_Lease_Period \000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000aFROM \000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID \000d\000aJOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; SQL statement:
SELECT 
gps.TRXN_Timestamp AS TRXN_Timestamp,
 gps.Car_Driving_Status AS Car_Driving_Status,
 gps.Current_Longitude AS Current_Longitude,
 gps.Current_Latitude AS Current_Latitude,
 gps.Current_Area AS Current_Area,
 gps.KM AS KM,

st.Amount AS Amount,
cd .Mobile_No AS Customer_ Mobile_Number,
 cd .Name AS Customer_Name,
 cd.Gender AS Customer_Gender,
 cd.Age AS Customer_Age,
  cd.Nationality AS Customer_Nationality,
  cd.Passport_No AS Customer_Passport_No,
  cd.ID_No AS Customer_Id_No,
  cd.Home_Address AS Customer_Home_address,
   cd.Lease_Start_Date AS Customer_Lease_Start_Date ,
   cd.Lease_Period AS Customer_Lease_Period 






FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID 
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42000-224]
2024-08-06 10:25:34.527927+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000agps.TRXN_Timestamp AS TRXN_Timestamp,\000d\000a gps.Car_Driving_Status AS Car_Driving_Status,\000d\000a gps.Current_Longitude AS Current_Longitude,\000d\000a gps.Current_Latitude AS Current_Latitude,\000d\000a gps.Current_Area AS Current_Area,\000d\000a gps.KM AS KM,\000d\000a\000d\000ast.Amount AS Amount,\000d\000acd .Mobile_No AS Customer_ [*]Mobile_Number,\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000aFROM \000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID \000d\000aJOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; SQL statement:
SELECT 
gps.TRXN_Timestamp AS TRXN_Timestamp,
 gps.Car_Driving_Status AS Car_Driving_Status,
 gps.Current_Longitude AS Current_Longitude,
 gps.Current_Latitude AS Current_Latitude,
 gps.Current_Area AS Current_Area,
 gps.KM AS KM,

st.Amount AS Amount,
cd .Mobile_No AS Customer_ Mobile_Number,







FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID 
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42000-224]
2024-08-06 10:25:41.460574+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000agps.TRXN_Timestamp AS TRXN_Timestamp,\000d\000a gps.Car_Driving_Status AS Car_Driving_Status,\000d\000a gps.Current_Longitude AS Current_Longitude,\000d\000a gps.Current_Latitude AS Current_Latitude,\000d\000a gps.Current_Area AS Current_Area,\000d\000a gps.KM AS KM,\000d\000a\000d\000ast.Amount AS Amount,\000d\000acd .Mobile_No AS Customer_ [*]Mobile_Number\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000aFROM \000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID \000d\000aJOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; SQL statement:
SELECT 
gps.TRXN_Timestamp AS TRXN_Timestamp,
 gps.Car_Driving_Status AS Car_Driving_Status,
 gps.Current_Longitude AS Current_Longitude,
 gps.Current_Latitude AS Current_Latitude,
 gps.Current_Area AS Current_Area,
 gps.KM AS KM,

st.Amount AS Amount,
cd .Mobile_No AS Customer_ Mobile_Number







FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID 
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42000-224]
2024-08-06 10:25:46.006219+04:00 jdbc[34]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000agps.TRXN_Timestamp AS TRXN_Timestamp,\000d\000a gps.Car_Driving_Status AS Car_Driving_Status,\000d\000a gps.Current_Longitude AS Current_Longitude,\000d\000a gps.Current_Latitude AS Current_Latitude,\000d\000a gps.Current_Area AS Current_Area,\000d\000a gps.KM AS KM,\000d\000a\000d\000ast.Amount AS Amount,\000d\000acd.Mobile_No AS Customer_ [*]Mobile_Number\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000a\000d\000aFROM \000d\000a\000d\000aGPS_TRANSACTIONS gps\000d\000a \000d\000aJOIN  CAR_DATA car ON car.car_id =  gps.car_id\000d\000aJOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID \000d\000aJOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID \000d\000aJOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID"; SQL statement:
SELECT 
gps.TRXN_Timestamp AS TRXN_Timestamp,
 gps.Car_Driving_Status AS Car_Driving_Status,
 gps.Current_Longitude AS Current_Longitude,
 gps.Current_Latitude AS Current_Latitude,
 gps.Current_Area AS Current_Area,
 gps.KM AS KM,

st.Amount AS Amount,
cd.Mobile_No AS Customer_ Mobile_Number







FROM 

GPS_TRANSACTIONS gps
 
JOIN  CAR_DATA car ON car.car_id =  gps.car_id
JOIN  SALES_AGENT_DATA sgd on  sgd.AGENT_ID = gps.AGENT_ID 
JOIN  CUSTOMER_DATA  cd on cd .CUSTOMER_ID = gps.CUSTOMER_ID
JOIN OFFICE_BRANCH_DATA  obd on obd.OFFICE_ID= gps.OFFICE_ID 
JOIN  Sales_Transactions st ON st.Customer_ID = gps.Customer_ID AND st.Car_ID = gps.Car_ID AND st.Office_ID = gps.Office_ID AND st.Agent_ID = gps.Agent_ID [42000-224]
2024-08-06 10:34:23.657974+04:00 jdbc[45]: null
org.h2.message.DbException: The connection was not closed by the application and is garbage collected [90018-224]
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.closeOld(JdbcConnection.java:218)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:135)
	at org.h2.Driver.connect(Driver.java:59)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:137)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:360)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:202)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:461)
	at com.zaxxer.hikari.pool.HikariPool$PoolEntryCreator.call(HikariPool.java:724)
	at com.zaxxer.hikari.pool.HikariPool$PoolEntryCreator.call(HikariPool.java:703)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.h2.jdbc.JdbcSQLNonTransientConnectionException: The connection was not closed by the application and is garbage collected [90018-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 16 more
2024-08-06 10:37:27.735488+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "CUSTOM_GPS_TRANSACTION_DATA" not found; SQL statement:
select * from custom_gps_transaction_data [42102-224]
2024-08-06 10:37:28.456224+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "CUSTOM_GPS_TRANSACTION_DATA" not found; SQL statement:
select * from custom_gps_transaction_data [42102-224]
2024-08-06 10:44:17.174255+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "CUSTOMER_GPS_TRANSACTION_DATA" not found; SQL statement:
select * from customer_gps_transaction_data [42102-224]
2024-08-06 10:51:46.223213+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "CSD1_0.ID" not found; SQL statement:
select csd1_0.id,csd1_0.agent_age,csd1_0.agent_age_band,csd1_0.agent_gender,csd1_0.agent_mobile_no,csd1_0.agent_name,csd1_0.agent_nationality,csd1_0.amount,csd1_0.car_driving_status,csd1_0.car_make,csd1_0.car_model,csd1_0.car_plate_no,csd1_0.car_registration_date,csd1_0.car_registration_expiry_date,csd1_0.current_area,csd1_0.current_latitude,csd1_0.current_longitude,csd1_0.customer_age,csd1_0.customer_age_band,csd1_0.customer_gender,csd1_0.customer_home_address,csd1_0.customer_id_no,csd1_0.customer_lease_period,csd1_0.customer_lease_start_date,csd1_0.customer_mobile_no,csd1_0.customer_name,csd1_0.customer_nationality,csd1_0.customer_passport_no,csd1_0.km,csd1_0.office_area,csd1_0.office_mobile_no,csd1_0.office_no,csd1_0.office_working_hours,csd1_0.trx_timestamp from customer_gps_transaction_data csd1_0 [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:93)
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:316)
	at com.zaxxer.hikari.pool.ProxyConnection.prepareStatement(ProxyConnection.java:328)
	at com.zaxxer.hikari.pool.HikariProxyConnection.prepareStatement(HikariProxyConnection.java)
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$5.doPrepare(StatementPreparerImpl.java:153)
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:183)
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareQueryStatement(StatementPreparerImpl.java:155)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.lambda$list$0(JdbcSelectExecutor.java:85)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:231)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:167)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.advanceNext(JdbcValuesResultSetImpl.java:265)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.processNext(JdbcValuesResultSetImpl.java:145)
	at org.hibernate.sql.results.jdbc.internal.AbstractJdbcValues.next(AbstractJdbcValues.java:19)
	at org.hibernate.sql.results.internal.RowProcessingStateStandardImpl.next(RowProcessingStateStandardImpl.java:67)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:204)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:33)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:211)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:83)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:76)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:65)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$2(ConcreteSqmSelectQueryPlan.java:139)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:382)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:302)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:526)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:423)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.findAll(SimpleJpaRepository.java:391)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.findAll(SimpleJpaRepository.java:1)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:516)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:285)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:628)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:168)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:143)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy120.findAll(Unknown Source)
	at com.engine.ingest.controller.CustomerSalesDataController.getAllCustomerSalesData(CustomerSalesDataController.java:22)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 10:53:17.348339+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "CSD1_0.ID" not found; SQL statement:
select csd1_0.id,csd1_0.agent_age,csd1_0.agent_age_band,csd1_0.agent_gender,csd1_0.agent_mobile_no,csd1_0.agent_name,csd1_0.agent_nationality,csd1_0.am
ount,csd1_0.car_driving_status,csd1_0.car_make,csd1_0.car_model,csd1_0.car_plate_no,csd1_0.car_registration_date,csd1_0.car_registration_expiry_date,csd1_0.current_area,csd1_0.curr
ent_latitude,csd1_0.current_longitude,csd1_0.customer_age,csd1_0.customer_age_band,csd1_0.customer_gender,csd1_0.customer_home_address,csd1_0.customer_id_no,csd1_0.customer_lease_p
eriod,csd1_0.customer_lease_start_date,csd1_0.customer_mobile_no,csd1_0.customer_name,csd1_0.customer_nationality,csd1_0.customer_passport_no,csd1_0.km,csd1_0.office_area,csd1_0.office_mobile_no,csd1_0.office_no,csd1_0.office_working_hours,csd1_0.trx_timestamp from customer_gps_transaction_data csd1_0 [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 10:53:29.234705+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "CSD1_0.AM" not found; SQL statement:
select csd1_0.agent_age,csd1_0.agent_age_band,csd1_0.agent_gender,csd1_0.agent_mobile_no,csd1_0.agent_name,csd1_0.agent_nationality,csd1_0.am
ount,csd1_0.car_driving_status,csd1_0.car_make,csd1_0.car_model,csd1_0.car_plate_no,csd1_0.car_registration_date,csd1_0.car_registration_expiry_date,csd1_0.current_area,csd1_0.curr
ent_latitude,csd1_0.current_longitude,csd1_0.customer_age,csd1_0.customer_age_band,csd1_0.customer_gender,csd1_0.customer_home_address,csd1_0.customer_id_no,csd1_0.customer_lease_p
eriod,csd1_0.customer_lease_start_date,csd1_0.customer_mobile_no,csd1_0.customer_name,csd1_0.customer_nationality,csd1_0.customer_passport_no,csd1_0.km,csd1_0.office_area,csd1_0.office_mobile_no,csd1_0.office_no,csd1_0.office_working_hours,csd1_0.trx_timestamp from customer_gps_transaction_data csd1_0 [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.Alias.optimize(Alias.java:52)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 10:53:29.791556+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "CSD1_0.AM" not found; SQL statement:
select csd1_0.agent_age,csd1_0.agent_age_band,csd1_0.agent_gender,csd1_0.agent_mobile_no,csd1_0.agent_name,csd1_0.agent_nationality,csd1_0.am
ount,csd1_0.car_driving_status,csd1_0.car_make,csd1_0.car_model,csd1_0.car_plate_no,csd1_0.car_registration_date,csd1_0.car_registration_expiry_date,csd1_0.current_area,csd1_0.curr
ent_latitude,csd1_0.current_longitude,csd1_0.customer_age,csd1_0.customer_age_band,csd1_0.customer_gender,csd1_0.customer_home_address,csd1_0.customer_id_no,csd1_0.customer_lease_p
eriod,csd1_0.customer_lease_start_date,csd1_0.customer_mobile_no,csd1_0.customer_name,csd1_0.customer_nationality,csd1_0.customer_passport_no,csd1_0.km,csd1_0.office_area,csd1_0.office_mobile_no,csd1_0.office_no,csd1_0.office_working_hours,csd1_0.trx_timestamp from customer_gps_transaction_data csd1_0 [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.Alias.optimize(Alias.java:52)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 10:58:55.453994+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "drop  [*]CUSTOMER_DATA_VIEW"; expected "TABLE, INDEX, USER, SEQUENCE, CONSTANT, TRIGGER, MATERIALIZED, VIEW, ROLE, ALIAS, SCHEMA, ALL OBJECTS, DOMAIN, TYPE, AGGREGATE, SYNONYM"; SQL statement:
drop  CUSTOMER_DATA_VIEW [42001-224]
2024-08-06 10:59:01.464308+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: View "CUSTOMER_DATA_VIEW" not found; SQL statement:
drop view CUSTOMER_DATA_VIEW [90037-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.ddl.DropView.update(DropView.java:59)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:256)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:262)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 10:59:18.704775+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: View "CUSTOMER_DATA_VIEW" not found; SQL statement:
Drop view CUSTOMER_DATA_VIEW [90037-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.ddl.DropView.update(DropView.java:59)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:256)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:262)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 10:59:34.249797+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: View "CUSTOMER_DATA_VIEW" already exists; SQL statement:
CREATE VIEW CUSTOMER_DATA_VIEW AS
SELECT
    gps.TRXN_TIMESTAMP AS TRXN_Timestamp,
    gps.CAR_DRIVING_STATUS AS Car_Driving_Status,
    gps.CURRENT_LONGITUDE AS Current_Longitude,
    gps.CURRENT_LATITUDE AS Current_Latitude,
    gps.CURRENT_AREA AS Current_Area,
    gps.KM AS KM,

    st.AMOUNT AS Amount,

    cd.MOBILE_NO AS customer_mobile_no,
    cd.NAME AS Customer_Name,
    cd.GENDER AS Customer_Gender,
    cd.AGE AS Customer_Age,
    CASE
        WHEN cd.AGE < 18 THEN '<18'
        WHEN cd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN cd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Customer_Age_Band,
    cd.NATIONALITY AS Customer_Nationality,
    cd.PASSPORT_NO AS Customer_PassportNo,
    cd.ID_NO AS Customer_Id_No,
    cd.HOME_ADDRESS AS Customer_Home_address,
    cd.LEASE_START_DATE AS Customer_Lease_Start_Date,
    cd.LEASE_PERIOD AS Customer_Lease_Period,

    car.CAR_MAKE AS Car_Make,
    car.CAR_MODEL AS Car_Model,
    car.PLATE_NO AS Car_Plate_No,
    car.REGISTRATION_DATE AS Car_Registration_Date,
    car.REGISTRATION_EXPIRY_DATE AS Car_Registration_Expiry_Date,

    obd.MOBILE_NO AS Office_Mobile_No,
    obd.AREA AS Office_Area,
    obd.OFFICE_NO AS Office_Office_No,
    obd.WORKING_HOURS AS Office_Working_Hours,

    sgd.MOBILE_NO AS Agent_Mobile_No,
    sgd.NAME AS Agent_Name,
    sgd.GENDER AS Agent_Gender,
    sgd.AGE AS Agent_Age,
    CASE
        WHEN sgd.AGE < 18 THEN '<18'
        WHEN sgd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN sgd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Agent_Age_Band,
    sgd.NATIONALITY AS Agent_Nationality

FROM
    GPS_TRANSACTIONS gps
JOIN
    CAR_DATA car ON car.CAR_ID = gps.CAR_ID
JOIN
    SALES_AGENT_DATA sgd ON sgd.AGENT_ID = gps.AGENT_ID
JOIN
    CUSTOMER_DATA cd ON cd.CUSTOMER_ID = gps.CUSTOMER_ID
JOIN
    OFFICE_BRANCH_DATA obd ON obd.OFFICE_ID = gps.OFFICE_ID
JOIN
    SALES_TRANSACTIONS st ON st.CUSTOMER_ID = gps.CUSTOMER_ID
    AND st.CAR_ID = gps.CAR_ID
    AND st.OFFICE_ID = gps.OFFICE_ID
    AND st.AGENT_ID = gps.AGENT_ID [90038-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.ddl.CreateView.update(CreateView.java:90)
	at org.h2.command.ddl.SchemaOwnerCommand.update(SchemaOwnerCommand.java:33)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:256)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:262)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 11:00:00.619735+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: View "CUSTOMER_DATA_VIEW" not found; SQL statement:
DROP VIEW CUSTOMER_DATA_VIEW [90037-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.ddl.DropView.update(DropView.java:59)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:256)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:262)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 11:06:18.157002+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "CSDV1_0.CUSTOMER_PASSPORT_NO" not found; SQL statement:
select csdv1_0.trxn_timestamp,csdv1_0.agent_age,csdv1_0.agent_gender,csdv1_0.agent_mobile_no,csdv1_0.agent_name,csdv1_0.agent_nationality,csdv1_0.amount,csdv1_0.car_driving_status,csdv1_0.car_make,csdv1_0.car_model,csdv1_0.car_plate_no,csdv1_0.car_registration_date,csdv1_0.car_registration_expiry_date,csdv1_0.current_area,csdv1_0.current_latitude,csdv1_0.current_longitude,csdv1_0.customer_age,csdv1_0.customer_gender,csdv1_0.customer_home_address,csdv1_0.customer_id_no,csdv1_0.customer_lease_period,csdv1_0.customer_lease_start_date,csdv1_0.customer_mobile_no,csdv1_0.customer_name,csdv1_0.customer_nationality,csdv1_0.customer_passport_no,csdv1_0.km,csdv1_0.office_area,csdv1_0.office_mobile_no,csdv1_0.office_office_no,csdv1_0.office_working_hours from customer_data_view csdv1_0 [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:93)
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:316)
	at com.zaxxer.hikari.pool.ProxyConnection.prepareStatement(ProxyConnection.java:328)
	at com.zaxxer.hikari.pool.HikariProxyConnection.prepareStatement(HikariProxyConnection.java)
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$5.doPrepare(StatementPreparerImpl.java:153)
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:183)
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareQueryStatement(StatementPreparerImpl.java:155)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.lambda$list$0(JdbcSelectExecutor.java:85)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:231)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:167)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.advanceNext(JdbcValuesResultSetImpl.java:265)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.processNext(JdbcValuesResultSetImpl.java:145)
	at org.hibernate.sql.results.jdbc.internal.AbstractJdbcValues.next(AbstractJdbcValues.java:19)
	at org.hibernate.sql.results.internal.RowProcessingStateStandardImpl.next(RowProcessingStateStandardImpl.java:67)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:204)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:33)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:211)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:83)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:76)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:65)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$2(ConcreteSqmSelectQueryPlan.java:139)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:382)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:302)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:526)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:423)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.findAll(SimpleJpaRepository.java:391)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.findAll(SimpleJpaRepository.java:1)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:516)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:285)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:628)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:168)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:143)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy121.findAll(Unknown Source)
	at com.engine.ingest.controller.CustomerSalesDataController.getAllCustomerSalesData(CustomerSalesDataController.java:23)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 11:25:04.974860+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: View "CUSTOMER_DATA_VIEW" already exists; SQL statement:
create view CUSTOMER_DATA_VIEW as

SELECT 
    gps.TRXN_TIMESTAMP AS TRXN_Timestamp,
    gps.CAR_DRIVING_STATUS AS Car_Driving_Status,
    gps.CURRENT_LONGITUDE AS Current_Longitude,
    gps.CURRENT_LATITUDE AS Current_Latitude,
    gps.CURRENT_AREA AS Current_Area,
    gps.KM AS KM,
    st.AMOUNT AS Amount,
    cd.MOBILE_NO AS customer_mobile_no,
    cd.NAME AS Customer_Name,
    cd.GENDER AS Customer_Gender,
    cd.AGE AS Customer_Age,
    CASE 
        WHEN cd.AGE < 18 THEN '<18'
        WHEN cd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN cd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Customer_Age_Band,
    cd.NATIONALITY AS Customer_Nationality,
    cd.PASSPORT_NO AS Customer_Passport_No,
    cd.ID_NO AS Customer_Id_No,
    cd.HOME_ADDRESS AS Customer_Home_address,
    cd.LEASE_START_DATE AS Customer_Lease_Start_Date,
    cd.LEASE_PERIOD AS Customer_Lease_Period,
    car.CAR_MAKE AS Car_Make,
    car.CAR_MODEL AS Car_Model,
    car.PLATE_NO AS Car_Plate_No,
    car.REGISTRATION_DATE AS Car_Registration_Date,
    car.REGISTRATION_EXPIRY_DATE AS Car_Registration_Expiry_Date,
    obd.MOBILE_NO AS Office_Mobile_No,
    obd.AREA AS Office_Area,
    obd.OFFICE_NO AS Office_Office_No,
    obd.WORKING_HOURS AS Office_Working_Hours,
    sgd.MOBILE_NO AS Agent_Mobile_No,
    sgd.NAME AS Agent_Name,
    sgd.GENDER AS Agent_Gender,
    sgd.AGE AS Agent_Age,
    CASE 
        WHEN sgd.AGE < 18 THEN '<18'
        WHEN sgd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN sgd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Agent_Age_Band,
    sgd.NATIONALITY AS Agent_Nationality
FROM 
    GPS_TRANSACTIONS gps
JOIN 
    CAR_DATA car ON car.CAR_ID = gps.CAR_ID
JOIN 
    SALES_AGENT_DATA sgd ON sgd.AGENT_ID = gps.AGENT_ID
JOIN 
    CUSTOMER_DATA cd ON cd.CUSTOMER_ID = gps.CUSTOMER_ID
JOIN 
    OFFICE_BRANCH_DATA obd ON obd.OFFICE_ID = gps.OFFICE_ID
JOIN 
    SALES_TRANSACTIONS st ON st.CUSTOMER_ID = gps.CUSTOMER_ID 
    AND st.CAR_ID = gps.CAR_ID 
    AND st.OFFICE_ID = gps.OFFICE_ID 
    AND st.AGENT_ID = gps.AGENT_ID [90038-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.ddl.CreateView.update(CreateView.java:90)
	at org.h2.command.ddl.SchemaOwnerCommand.update(SchemaOwnerCommand.java:33)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:256)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:262)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2024-08-06 11:25:11.862898+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "create view CUSTOMER_DATA_VIEW \000d\000a\000d\000a[*]SELECT \000d\000a    gps.TRXN_TIMESTAMP AS TRXN_Timestamp,\000d\000a    gps.CAR_DRIVING_STATUS AS Car_Driving_Status,\000d\000a    gps.CURRENT_LONGITUDE AS Current_Longitude,\000d\000a    gps.CURRENT_LATITUDE AS Current_Latitude,\000d\000a    gps.CURRENT_AREA AS Current_Area,\000d\000a    gps.KM AS KM,\000d\000a    st.AMOUNT AS Amount,\000d\000a    cd.MOBILE_NO AS customer_mobile_no,\000d\000a    cd.NAME AS Customer_Name,\000d\000a    cd.GENDER AS Customer_Gender,\000d\000a    cd.AGE AS Customer_Age,\000d\000a    CASE \000d\000a        WHEN cd.AGE < 18 THEN '<18'\000d\000a        WHEN cd.AGE BETWEEN 19 AND 30 THEN '19-30'\000d\000a        WHEN cd.AGE BETWEEN 31 AND 50 THEN '31-50'\000d\000a        ELSE '51+'\000d\000a    END AS Customer_Age_Band,\000d\000a    cd.NATIONALITY AS Customer_Nationality,\000d\000a    cd.PASSPORT_NO AS Customer_Passport_No,\000d\000a    cd.ID_NO AS Customer_Id_No,\000d\000a    cd.HOME_ADDRESS AS Customer_Home_address,\000d\000a    cd.LEASE_START_DATE AS Customer_Lease_Start_Date,\000d\000a    cd.LEASE_PERIOD AS Customer_Lease_Period,\000d\000a    car.CAR_MAKE AS Car_Make,\000d\000a    car.CAR_MODEL AS Car_Model,\000d\000a    car.PLATE_NO AS Car_Plate_No,\000d\000a    car.REGISTRATION_DATE AS Car_Registration_Date,\000d\000a    car.REGISTRATION_EXPIRY_DATE AS Car_Registration_Expiry_Date,\000d\000a    obd.MOBILE_NO AS Office_Mobile_No,\000d\000a    obd.AREA AS Office_Area,\000d\000a    obd.OFFICE_NO AS Office_Office_No,\000d\000a    obd.WORKING_HOURS AS Office_Working_Hours,\000d\000a    sgd.MOBILE_NO AS Agent_Mobile_No,\000d\000a    sgd.NAME AS Agent_Name,\000d\000a    sgd.GENDER AS Agent_Gender,\000d\000a    sgd.AGE AS Agent_Age,\000d\000a    CASE \000d\000a        WHEN sgd.AGE < 18 THEN '<18'\000d\000a        WHEN sgd.AGE BETWEEN 19 AND 30 THEN '19-30'\000d\000a        WHEN sgd.AGE BETWEEN 31 AND 50 THEN '31-50'\000d\000a        ELSE '51+'\000d\000a    END AS Agent_Age_Band,\000d\000a    sgd.NATIONALITY AS Agent_Nationality\000d\000aFROM \000d\000a    GPS_TRANSACTIONS gps\000d\000aJOIN \000d\000a    CAR_DATA car ON car.CAR_ID = gps.CAR_ID\000d\000aJOIN \000d\000a    SALES_AGENT_DATA sgd ON sgd.AGENT_ID = gps.AGENT_ID\000d\000aJOIN \000d\000a    CUSTOMER_DATA cd ON cd.CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN \000d\000a    OFFICE_BRANCH_DATA obd ON obd.OFFICE_ID = gps.OFFICE_ID\000d\000aJOIN \000d\000a    SALES_TRANSACTIONS st ON st.CUSTOMER_ID = gps.CUSTOMER_ID \000d\000a    AND st.CAR_ID = gps.CAR_ID \000d\000a    AND st.OFFICE_ID = gps.OFFICE_ID \000d\000a    AND st.AGENT_ID = gps.AGENT_ID"; expected "., COMMENT, (, AS"; SQL statement:
create view CUSTOMER_DATA_VIEW 

SELECT 
    gps.TRXN_TIMESTAMP AS TRXN_Timestamp,
    gps.CAR_DRIVING_STATUS AS Car_Driving_Status,
    gps.CURRENT_LONGITUDE AS Current_Longitude,
    gps.CURRENT_LATITUDE AS Current_Latitude,
    gps.CURRENT_AREA AS Current_Area,
    gps.KM AS KM,
    st.AMOUNT AS Amount,
    cd.MOBILE_NO AS customer_mobile_no,
    cd.NAME AS Customer_Name,
    cd.GENDER AS Customer_Gender,
    cd.AGE AS Customer_Age,
    CASE 
        WHEN cd.AGE < 18 THEN '<18'
        WHEN cd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN cd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Customer_Age_Band,
    cd.NATIONALITY AS Customer_Nationality,
    cd.PASSPORT_NO AS Customer_Passport_No,
    cd.ID_NO AS Customer_Id_No,
    cd.HOME_ADDRESS AS Customer_Home_address,
    cd.LEASE_START_DATE AS Customer_Lease_Start_Date,
    cd.LEASE_PERIOD AS Customer_Lease_Period,
    car.CAR_MAKE AS Car_Make,
    car.CAR_MODEL AS Car_Model,
    car.PLATE_NO AS Car_Plate_No,
    car.REGISTRATION_DATE AS Car_Registration_Date,
    car.REGISTRATION_EXPIRY_DATE AS Car_Registration_Expiry_Date,
    obd.MOBILE_NO AS Office_Mobile_No,
    obd.AREA AS Office_Area,
    obd.OFFICE_NO AS Office_Office_No,
    obd.WORKING_HOURS AS Office_Working_Hours,
    sgd.MOBILE_NO AS Agent_Mobile_No,
    sgd.NAME AS Agent_Name,
    sgd.GENDER AS Agent_Gender,
    sgd.AGE AS Agent_Age,
    CASE 
        WHEN sgd.AGE < 18 THEN '<18'
        WHEN sgd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN sgd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Agent_Age_Band,
    sgd.NATIONALITY AS Agent_Nationality
FROM 
    GPS_TRANSACTIONS gps
JOIN 
    CAR_DATA car ON car.CAR_ID = gps.CAR_ID
JOIN 
    SALES_AGENT_DATA sgd ON sgd.AGENT_ID = gps.AGENT_ID
JOIN 
    CUSTOMER_DATA cd ON cd.CUSTOMER_ID = gps.CUSTOMER_ID
JOIN 
    OFFICE_BRANCH_DATA obd ON obd.OFFICE_ID = gps.OFFICE_ID
JOIN 
    SALES_TRANSACTIONS st ON st.CUSTOMER_ID = gps.CUSTOMER_ID 
    AND st.CAR_ID = gps.CAR_ID 
    AND st.OFFICE_ID = gps.OFFICE_ID 
    AND st.AGENT_ID = gps.AGENT_ID [42001-224]
2024-08-06 11:47:56.111111+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "CSV.COUNT" not found; SQL statement:
SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status, SUM(csv.count) AS count FROM CUSTOMER_DATA_VIEW csv GROUP BY csv.Current_Area, csv.Car_Driving_Status [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.aggregate.AbstractAggregate.optimize(AbstractAggregate.java:101)
	at org.h2.expression.aggregate.Aggregate.optimize(Aggregate.java:948)
	at org.h2.expression.Alias.optimize(Alias.java:52)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2024-08-06 11:48:00.757346+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "CSV" not found; SQL statement:
SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status, SUM(csv) AS count FROM CUSTOMER_DATA_VIEW csv GROUP BY csv.Current_Area, csv.Car_Driving_Status [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.aggregate.AbstractAggregate.optimize(AbstractAggregate.java:101)
	at org.h2.expression.aggregate.Aggregate.optimize(Aggregate.java:948)
	at org.h2.expression.Alias.optimize(Alias.java:52)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2024-08-06 11:48:05.270719+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status, SUM([*]*) AS count FROM CUSTOMER_DATA_VIEW csv GROUP BY csv.Current_Area, csv.Car_Driving_Status"; expected "DISTINCT, ALL, INTERSECTS (, NOT, EXISTS, UNIQUE, INTERSECTS"; SQL statement:
SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status, SUM(*) AS count FROM CUSTOMER_DATA_VIEW csv GROUP BY csv.Current_Area, csv.Car_Driving_Status [42001-224]
2024-08-06 11:48:05.844395+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status, SUM([*]*) AS count FROM CUSTOMER_DATA_VIEW csv GROUP BY csv.Current_Area, csv.Car_Driving_Status"; expected "DISTINCT, ALL, INTERSECTS (, NOT, EXISTS, UNIQUE, INTERSECTS"; SQL statement:
SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status, SUM(*) AS count FROM CUSTOMER_DATA_VIEW csv GROUP BY csv.Current_Area, csv.Car_Driving_Status [42001-224]
2024-08-06 11:48:19.049999+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: SUM or AVG on wrong data type for "SUM(CSV.CURRENT_AREA)"; SQL statement:
SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status, SUM( csv.Current_Area) AS count FROM CUSTOMER_DATA_VIEW csv GROUP BY csv.Current_Area, csv.Car_Driving_Status [90015-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.aggregate.Aggregate.optimize(Aggregate.java:1009)
	at org.h2.expression.Alias.optimize(Alias.java:52)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2024-08-06 11:48:49.143762+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status [*]AS count FROM CUSTOMER_DATA_VIEW csv"; SQL statement:
SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status AS count FROM CUSTOMER_DATA_VIEW csv [42000-224]
2024-08-06 11:48:49.773533+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status [*]AS count FROM CUSTOMER_DATA_VIEW csv"; SQL statement:
SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status AS count FROM CUSTOMER_DATA_VIEW csv [42000-224]
2024-08-06 11:50:20.309200+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Invalid use of aggregate function "COUNT(*)"; SQL statement:
SELECT csv.Current_Area AS area, csv.Car_Driving_Status AS status , SUM(count(*))   FROM CUSTOMER_DATA_VIEW csv GROUP BY csv.Current_Area, csv.Car_Driving_Status [90054-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.analysis.DataAnalysisOperation.mapColumns(DataAnalysisOperation.java:137)
	at org.h2.expression.aggregate.AbstractAggregate.mapColumnsAnalysis(AbstractAggregate.java:90)
	at org.h2.expression.aggregate.Aggregate.mapColumnsAnalysis(Aggregate.java:943)
	at org.h2.expression.analysis.DataAnalysisOperation.mapColumns(DataAnalysisOperation.java:141)
	at org.h2.command.query.Select.mapColumns(Select.java:1558)
	at org.h2.command.query.Select.init(Select.java:1100)
	at org.h2.command.Parser.parseQuery(Parser.java:2501)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2024-08-06 12:52:15.795218+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: View "CUSTOMER_DATA_VIEW" already exists; SQL statement:
create view CUSTOMER_DATA_VIEW as 

SELECT 
    gps.TRXN_TIMESTAMP AS TRXN_Timestamp,
    gps.CAR_DRIVING_STATUS AS Car_Driving_Status,
    gps.CURRENT_LONGITUDE AS Current_Longitude,
    gps.CURRENT_LATITUDE AS Current_Latitude,
    gps.CURRENT_AREA AS Current_Area,
    gps.KM AS KM,
    st.AMOUNT AS Amount,
    cd.MOBILE_NO AS customer_mobile_no,
    cd.ANONYMIZED_MOBILE_NO as customer_anonymized_mobile_no,
    cd.NAME AS Customer_Name,
    cd.GENDER AS Customer_Gender,
    cd.AGE AS Customer_Age,
    CASE 
        WHEN cd.AGE < 18 THEN '<18'
        WHEN cd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN cd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Customer_Age_Band,
    cd.NATIONALITY AS Customer_Nationality,
    cd.PASSPORT_NO AS Customer_Passport_No,
    cd.ID_NO AS Customer_Id_No,
    cd.HOME_ADDRESS AS Customer_Home_address,
    cd.LEASE_START_DATE AS Customer_Lease_Start_Date,
    cd.LEASE_PERIOD AS Customer_Lease_Period,
    car.CAR_MAKE AS Car_Make,
    car.CAR_MODEL AS Car_Model,
    car.PLATE_NO AS Car_Plate_No,
    car.REGISTRATION_DATE AS Car_Registration_Date,
    car.REGISTRATION_EXPIRY_DATE AS Car_Registration_Expiry_Date,
    obd.MOBILE_NO AS Office_Mobile_No,
    obd.ANONYMIZED_MOBILE_NO as office_anonymized_mobile_no,
    obd.AREA AS Office_Area,
    obd.OFFICE_NO AS Office_Office_No,
    obd.WORKING_HOURS AS Office_Working_Hours,
    sgd.MOBILE_NO AS Agent_Mobile_No,
    sgd.ANONYMIZED_MOBILE_NO as agent_anonymized_mobile_no,
    sgd.NAME AS Agent_Name,
    sgd.GENDER AS Agent_Gender,
    sgd.AGE AS Agent_Age,
    CASE 
        WHEN sgd.AGE < 18 THEN '<18'
        WHEN sgd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN sgd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Agent_Age_Band,
    sgd.NATIONALITY AS Agent_Nationality
FROM 
    GPS_TRANSACTIONS gps
JOIN 
    CAR_DATA car ON car.CAR_ID = gps.CAR_ID
JOIN 
    SALES_AGENT_DATA sgd ON sgd.AGENT_ID = gps.AGENT_ID
JOIN 
    CUSTOMER_DATA cd ON cd.CUSTOMER_ID = gps.CUSTOMER_ID
JOIN 
    OFFICE_BRANCH_DATA obd ON obd.OFFICE_ID = gps.OFFICE_ID
JOIN 
    SALES_TRANSACTIONS st ON st.CUSTOMER_ID = gps.CUSTOMER_ID 
    AND st.CAR_ID = gps.CAR_ID 
    AND st.OFFICE_ID = gps.OFFICE_ID 
    AND st.AGENT_ID = gps.AGENT_ID [90038-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.ddl.CreateView.update(CreateView.java:90)
	at org.h2.command.ddl.SchemaOwnerCommand.update(SchemaOwnerCommand.java:33)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:256)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:262)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 12:56:28.823827+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "drop view CUSTOMER_DATA_VIEW \000d\000a\000d\000a[*]create view CUSTOMER_DATA_VIEW as \000d\000a\000d\000aSELECT \000d\000a    gps.TRXN_TIMESTAMP AS TRXN_Timestamp,\000d\000a    gps.CAR_DRIVING_STATUS AS Car_Driving_Status,\000d\000a    gps.CURRENT_LONGITUDE AS Current_Longitude,\000d\000a    gps.CURRENT_LATITUDE AS Current_Latitude,\000d\000a    gps.CURRENT_AREA AS Current_Area,\000d\000a    gps.KM AS KM,\000d\000a    st.AMOUNT AS Amount,\000d\000a    cd.MOBILE_NO AS customer_mobile_no,\000d\000a    cd.ANONYMIZED_MOBILE_NO as customer_anonymized_mobile_no,\000d\000a    cd.NAME AS Customer_Name,\000d\000a    cd.GENDER AS Customer_Gender,\000d\000a    cd.AGE AS Customer_Age,\000d\000a    CASE \000d\000a        WHEN cd.AGE < 18 THEN '<18'\000d\000a        WHEN cd.AGE BETWEEN 19 AND 30 THEN '19-30'\000d\000a        WHEN cd.AGE BETWEEN 31 AND 50 THEN '31-50'\000d\000a        ELSE '51+'\000d\000a    END AS Customer_Age_Band,\000d\000a    cd.NATIONALITY AS Customer_Nationality,\000d\000a    cd.PASSPORT_NO AS Customer_Passport_No,\000d\000a    cd.ID_NO AS Customer_Id_No,\000d\000a    cd.HOME_ADDRESS AS Customer_Home_address,\000d\000a    cd.LEASE_START_DATE AS Customer_Lease_Start_Date,\000d\000a    cd.LEASE_PERIOD AS Customer_Lease_Period,\000d\000a    car.CAR_MAKE AS Car_Make,\000d\000a    car.CAR_MODEL AS Car_Model,\000d\000a    car.PLATE_NO AS Car_Plate_No,\000d\000a    car.REGISTRATION_DATE AS Car_Registration_Date,\000d\000a    car.REGISTRATION_EXPIRY_DATE AS Car_Registration_Expiry_Date,\000d\000a    obd.MOBILE_NO AS Office_Mobile_No,\000d\000a    obd.ANONYMIZED_MOBILE_NO as office_anonymized_mobile_no,\000d\000a    obd.AREA AS Office_Area,\000d\000a    obd.OFFICE_NO AS Office_Office_No,\000d\000a    obd.WORKING_HOURS AS Office_Working_Hours,\000d\000a    sgd.MOBILE_NO AS Agent_Mobile_No,\000d\000a    sgd.ANONYMIZED_MOBILE_NO as agent_anonymized_mobile_no,\000d\000a    sgd.NAME AS Agent_Name,\000d\000a    sgd.GENDER AS Agent_Gender,\000d\000a    sgd.AGE AS Agent_Age,\000d\000a    CASE \000d\000a        WHEN sgd.AGE < 18 THEN '<18'\000d\000a        WHEN sgd.AGE BETWEEN 19 AND 30 THEN '19-30'\000d\000a        WHEN sgd.AGE BETWEEN 31 AND 50 THEN '31-50'\000d\000a        ELSE '51+'\000d\000a    END AS Agent_Age_Band,\000d\000a    sgd.NATIONALITY AS Agent_Nationality\000d\000aFROM \000d\000a    GPS_TRANSACTIONS gps\000d\000aJOIN \000d\000a    CAR_DATA car ON car.CAR_ID = gps.CAR_ID\000d\000aJOIN \000d\000a    SALES_AGENT_DATA sgd ON sgd.AGENT_ID = gps.AGENT_ID\000d\000aJOIN \000d\000a    CUSTOMER_DATA cd ON cd.CUSTOMER_ID = gps.CUSTOMER_ID\000d\000aJOIN \000d\000a    OFFICE_BRANCH_DATA obd ON obd.OFFICE_ID = gps.OFFICE_ID\000d\000aJOIN \000d\000a    SALES_TRANSACTIONS st ON st.CUSTOMER_ID = gps.CUSTOMER_ID \000d\000a    AND st.CAR_ID = gps.CAR_ID \000d\000a    AND st.OFFICE_ID = gps.OFFICE_ID \000d\000a    AND st.AGENT_ID = gps.AGENT_ID"; SQL statement:
drop view CUSTOMER_DATA_VIEW 

create view CUSTOMER_DATA_VIEW as 

SELECT 
    gps.TRXN_TIMESTAMP AS TRXN_Timestamp,
    gps.CAR_DRIVING_STATUS AS Car_Driving_Status,
    gps.CURRENT_LONGITUDE AS Current_Longitude,
    gps.CURRENT_LATITUDE AS Current_Latitude,
    gps.CURRENT_AREA AS Current_Area,
    gps.KM AS KM,
    st.AMOUNT AS Amount,
    cd.MOBILE_NO AS customer_mobile_no,
    cd.ANONYMIZED_MOBILE_NO as customer_anonymized_mobile_no,
    cd.NAME AS Customer_Name,
    cd.GENDER AS Customer_Gender,
    cd.AGE AS Customer_Age,
    CASE 
        WHEN cd.AGE < 18 THEN '<18'
        WHEN cd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN cd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Customer_Age_Band,
    cd.NATIONALITY AS Customer_Nationality,
    cd.PASSPORT_NO AS Customer_Passport_No,
    cd.ID_NO AS Customer_Id_No,
    cd.HOME_ADDRESS AS Customer_Home_address,
    cd.LEASE_START_DATE AS Customer_Lease_Start_Date,
    cd.LEASE_PERIOD AS Customer_Lease_Period,
    car.CAR_MAKE AS Car_Make,
    car.CAR_MODEL AS Car_Model,
    car.PLATE_NO AS Car_Plate_No,
    car.REGISTRATION_DATE AS Car_Registration_Date,
    car.REGISTRATION_EXPIRY_DATE AS Car_Registration_Expiry_Date,
    obd.MOBILE_NO AS Office_Mobile_No,
    obd.ANONYMIZED_MOBILE_NO as office_anonymized_mobile_no,
    obd.AREA AS Office_Area,
    obd.OFFICE_NO AS Office_Office_No,
    obd.WORKING_HOURS AS Office_Working_Hours,
    sgd.MOBILE_NO AS Agent_Mobile_No,
    sgd.ANONYMIZED_MOBILE_NO as agent_anonymized_mobile_no,
    sgd.NAME AS Agent_Name,
    sgd.GENDER AS Agent_Gender,
    sgd.AGE AS Agent_Age,
    CASE 
        WHEN sgd.AGE < 18 THEN '<18'
        WHEN sgd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN sgd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Agent_Age_Band,
    sgd.NATIONALITY AS Agent_Nationality
FROM 
    GPS_TRANSACTIONS gps
JOIN 
    CAR_DATA car ON car.CAR_ID = gps.CAR_ID
JOIN 
    SALES_AGENT_DATA sgd ON sgd.AGENT_ID = gps.AGENT_ID
JOIN 
    CUSTOMER_DATA cd ON cd.CUSTOMER_ID = gps.CUSTOMER_ID
JOIN 
    OFFICE_BRANCH_DATA obd ON obd.OFFICE_ID = gps.OFFICE_ID
JOIN 
    SALES_TRANSACTIONS st ON st.CUSTOMER_ID = gps.CUSTOMER_ID 
    AND st.CAR_ID = gps.CAR_ID 
    AND st.OFFICE_ID = gps.OFFICE_ID 
    AND st.AGENT_ID = gps.AGENT_ID [42000-224]
2024-08-06 12:56:33.532518+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: View "CUSTOMER_DATA_VIEW" already exists; SQL statement:
create view CUSTOMER_DATA_VIEW as 

SELECT 
    gps.TRXN_TIMESTAMP AS TRXN_Timestamp,
    gps.CAR_DRIVING_STATUS AS Car_Driving_Status,
    gps.CURRENT_LONGITUDE AS Current_Longitude,
    gps.CURRENT_LATITUDE AS Current_Latitude,
    gps.CURRENT_AREA AS Current_Area,
    gps.KM AS KM,
    st.AMOUNT AS Amount,
    cd.MOBILE_NO AS customer_mobile_no,
    cd.ANONYMIZED_MOBILE_NO as customer_anonymized_mobile_no,
    cd.NAME AS Customer_Name,
    cd.GENDER AS Customer_Gender,
    cd.AGE AS Customer_Age,
    CASE 
        WHEN cd.AGE < 18 THEN '<18'
        WHEN cd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN cd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Customer_Age_Band,
    cd.NATIONALITY AS Customer_Nationality,
    cd.PASSPORT_NO AS Customer_Passport_No,
    cd.ID_NO AS Customer_Id_No,
    cd.HOME_ADDRESS AS Customer_Home_address,
    cd.LEASE_START_DATE AS Customer_Lease_Start_Date,
    cd.LEASE_PERIOD AS Customer_Lease_Period,
    car.CAR_MAKE AS Car_Make,
    car.CAR_MODEL AS Car_Model,
    car.PLATE_NO AS Car_Plate_No,
    car.REGISTRATION_DATE AS Car_Registration_Date,
    car.REGISTRATION_EXPIRY_DATE AS Car_Registration_Expiry_Date,
    obd.MOBILE_NO AS Office_Mobile_No,
    obd.ANONYMIZED_MOBILE_NO as office_anonymized_mobile_no,
    obd.AREA AS Office_Area,
    obd.OFFICE_NO AS Office_Office_No,
    obd.WORKING_HOURS AS Office_Working_Hours,
    sgd.MOBILE_NO AS Agent_Mobile_No,
    sgd.ANONYMIZED_MOBILE_NO as agent_anonymized_mobile_no,
    sgd.NAME AS Agent_Name,
    sgd.GENDER AS Agent_Gender,
    sgd.AGE AS Agent_Age,
    CASE 
        WHEN sgd.AGE < 18 THEN '<18'
        WHEN sgd.AGE BETWEEN 19 AND 30 THEN '19-30'
        WHEN sgd.AGE BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+'
    END AS Agent_Age_Band,
    sgd.NATIONALITY AS Agent_Nationality
FROM 
    GPS_TRANSACTIONS gps
JOIN 
    CAR_DATA car ON car.CAR_ID = gps.CAR_ID
JOIN 
    SALES_AGENT_DATA sgd ON sgd.AGENT_ID = gps.AGENT_ID
JOIN 
    CUSTOMER_DATA cd ON cd.CUSTOMER_ID = gps.CUSTOMER_ID
JOIN 
    OFFICE_BRANCH_DATA obd ON obd.OFFICE_ID = gps.OFFICE_ID
JOIN 
    SALES_TRANSACTIONS st ON st.CUSTOMER_ID = gps.CUSTOMER_ID 
    AND st.CAR_ID = gps.CAR_ID 
    AND st.OFFICE_ID = gps.OFFICE_ID 
    AND st.AGENT_ID = gps.AGENT_ID [90038-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.ddl.CreateView.update(CreateView.java:90)
	at org.h2.command.ddl.SchemaOwnerCommand.update(SchemaOwnerCommand.java:33)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:256)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:262)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:33:29.215387+04:00 jdbc[13]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select ROW_NUMBER() [*]AS row_num from CUSTOMER_DATA"; expected "OVER"; SQL statement:
select ROW_NUMBER() AS row_num from CUSTOMER_DATA [42001-224]
2024-08-06 14:37:36.746609+04:00 database: wrong user or password; user: "SA"
org.h2.message.DbException: Wrong user name or password [28000-224]
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.engine.Engine.openSession(Engine.java:154)
	at org.h2.engine.Engine.openSession(Engine.java:222)
	at org.h2.engine.Engine.createSession(Engine.java:201)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:343)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:125)
	at org.h2.util.JdbcUtils.getConnection(JdbcUtils.java:288)
	at org.h2.server.web.WebServer.getConnection(WebServer.java:811)
	at org.h2.server.web.WebApp.login(WebApp.java:1039)
	at org.h2.server.web.WebApp.process(WebApp.java:227)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.h2.jdbc.JdbcSQLInvalidAuthorizationSpecException: Wrong user name or password [28000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:522)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 50 more
2024-08-06 14:39:46.124217+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcStatement.checkClosed(JdbcStatement.java:1289)
	at org.h2.jdbc.JdbcResultSet.checkClosed(JdbcResultSet.java:3539)
	at org.h2.jdbc.JdbcResultSet.next(JdbcResultSet.java:124)
	at com.zaxxer.hikari.pool.HikariProxyResultSet.next(HikariProxyResultSet.java)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.advanceNext(JdbcValuesResultSetImpl.java:265)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.processNext(JdbcValuesResultSetImpl.java:145)
	at org.hibernate.sql.results.jdbc.internal.AbstractJdbcValues.next(AbstractJdbcValues.java:19)
	at org.hibernate.sql.results.internal.RowProcessingStateStandardImpl.next(RowProcessingStateStandardImpl.java:67)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:189)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:33)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:211)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:83)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:76)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:65)
	at org.hibernate.loader.ast.internal.SingleIdLoadPlan.load(SingleIdLoadPlan.java:145)
	at org.hibernate.loader.ast.internal.SingleIdLoadPlan.load(SingleIdLoadPlan.java:117)
	at org.hibernate.loader.ast.internal.SingleIdEntityLoaderStandardImpl.load(SingleIdEntityLoaderStandardImpl.java:75)
	at org.hibernate.persister.entity.AbstractEntityPersister.doLoad(AbstractEntityPersister.java:3726)
	at org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3715)
	at org.hibernate.event.internal.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:604)
	at org.hibernate.event.internal.DefaultLoadEventListener.loadFromCacheOrDatasource(DefaultLoadEventListener.java:590)
	at org.hibernate.event.internal.DefaultLoadEventListener.load(DefaultLoadEventListener.java:560)
	at org.hibernate.event.internal.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:544)
	at org.hibernate.event.internal.DefaultLoadEventListener.load(DefaultLoadEventListener.java:207)
	at org.hibernate.event.internal.DefaultLoadEventListener.loadWithRegularProxy(DefaultLoadEventListener.java:290)
	at org.hibernate.event.internal.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:242)
	at org.hibernate.event.internal.DefaultLoadEventListener.doOnLoad(DefaultLoadEventListener.java:111)
	at org.hibernate.event.internal.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:68)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireLoadNoChecks(SessionImpl.java:1225)
	at org.hibernate.internal.SessionImpl.fireLoad(SessionImpl.java:1213)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.load(IdentifierLoadAccessImpl.java:209)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.doLoad(IdentifierLoadAccessImpl.java:160)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.lambda$load$1(IdentifierLoadAccessImpl.java:149)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.perform(IdentifierLoadAccessImpl.java:112)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.load(IdentifierLoadAccessImpl.java:149)
	at org.hibernate.internal.SessionImpl.get(SessionImpl.java:1026)
	at org.hibernate.event.internal.DefaultMergeEventListener.lambda$entityIsDetached$0(DefaultMergeEventListener.java:408)
	at org.hibernate.engine.spi.LoadQueryInfluencers.fromInternalFetchProfile(LoadQueryInfluencers.java:106)
	at org.hibernate.event.internal.DefaultMergeEventListener.entityIsDetached(DefaultMergeEventListener.java:406)
	at org.hibernate.event.internal.DefaultMergeEventListener.merge(DefaultMergeEventListener.java:210)
	at org.hibernate.event.internal.DefaultMergeEventListener.doMerge(DefaultMergeEventListener.java:148)
	at org.hibernate.event.internal.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:132)
	at org.hibernate.event.internal.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:86)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.fireMerge(SessionImpl.java:850)
	at org.hibernate.internal.SessionImpl.merge(SessionImpl.java:836)
	at jdk.internal.reflect.GeneratedMethodAccessor40.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:319)
	at jdk.proxy2/jdk.proxy2.$Proxy124.merge(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:632)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:516)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:285)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:628)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:168)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:143)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.145538+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcStatement.checkClosed(JdbcStatement.java:1289)
	at org.h2.jdbc.JdbcStatement.getMaxRows(JdbcStatement.java:476)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.getMaxRows(HikariProxyPreparedStatement.java)
	at org.hibernate.resource.jdbc.internal.ResourceRegistryStandardImpl.close(ResourceRegistryStandardImpl.java:193)
	at org.hibernate.resource.jdbc.internal.ResourceRegistryStandardImpl.release(ResourceRegistryStandardImpl.java:108)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.release(DeferredResultSetAccess.java:331)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.finishUp(JdbcValuesResultSetImpl.java:332)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:228)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:33)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:211)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:83)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:76)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:65)
	at org.hibernate.loader.ast.internal.SingleIdLoadPlan.load(SingleIdLoadPlan.java:145)
	at org.hibernate.loader.ast.internal.SingleIdLoadPlan.load(SingleIdLoadPlan.java:117)
	at org.hibernate.loader.ast.internal.SingleIdEntityLoaderStandardImpl.load(SingleIdEntityLoaderStandardImpl.java:75)
	at org.hibernate.persister.entity.AbstractEntityPersister.doLoad(AbstractEntityPersister.java:3726)
	at org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3715)
	at org.hibernate.event.internal.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:604)
	at org.hibernate.event.internal.DefaultLoadEventListener.loadFromCacheOrDatasource(DefaultLoadEventListener.java:590)
	at org.hibernate.event.internal.DefaultLoadEventListener.load(DefaultLoadEventListener.java:560)
	at org.hibernate.event.internal.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:544)
	at org.hibernate.event.internal.DefaultLoadEventListener.load(DefaultLoadEventListener.java:207)
	at org.hibernate.event.internal.DefaultLoadEventListener.loadWithRegularProxy(DefaultLoadEventListener.java:290)
	at org.hibernate.event.internal.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:242)
	at org.hibernate.event.internal.DefaultLoadEventListener.doOnLoad(DefaultLoadEventListener.java:111)
	at org.hibernate.event.internal.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:68)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireLoadNoChecks(SessionImpl.java:1225)
	at org.hibernate.internal.SessionImpl.fireLoad(SessionImpl.java:1213)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.load(IdentifierLoadAccessImpl.java:209)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.doLoad(IdentifierLoadAccessImpl.java:160)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.lambda$load$1(IdentifierLoadAccessImpl.java:149)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.perform(IdentifierLoadAccessImpl.java:112)
	at org.hibernate.loader.internal.IdentifierLoadAccessImpl.load(IdentifierLoadAccessImpl.java:149)
	at org.hibernate.internal.SessionImpl.get(SessionImpl.java:1026)
	at org.hibernate.event.internal.DefaultMergeEventListener.lambda$entityIsDetached$0(DefaultMergeEventListener.java:408)
	at org.hibernate.engine.spi.LoadQueryInfluencers.fromInternalFetchProfile(LoadQueryInfluencers.java:106)
	at org.hibernate.event.internal.DefaultMergeEventListener.entityIsDetached(DefaultMergeEventListener.java:406)
	at org.hibernate.event.internal.DefaultMergeEventListener.merge(DefaultMergeEventListener.java:210)
	at org.hibernate.event.internal.DefaultMergeEventListener.doMerge(DefaultMergeEventListener.java:148)
	at org.hibernate.event.internal.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:132)
	at org.hibernate.event.internal.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:86)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.fireMerge(SessionImpl.java:850)
	at org.hibernate.internal.SessionImpl.merge(SessionImpl.java:836)
	at jdk.internal.reflect.GeneratedMethodAccessor40.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:319)
	at jdk.proxy2/jdk.proxy2.$Proxy124.merge(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:632)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:354)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:516)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:285)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:628)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:168)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:143)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.207764+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.rollback(JdbcConnection.java:511)
	at com.zaxxer.hikari.pool.ProxyConnection.rollback(ProxyConnection.java:386)
	at com.zaxxer.hikari.pool.HikariProxyConnection.rollback(HikariProxyConnection.java)
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.rollback(AbstractLogicalConnectionImplementor.java:127)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.rollback(JdbcResourceLocalTransactionCoordinatorImpl.java:289)
	at org.hibernate.engine.transaction.internal.TransactionImpl.rollback(TransactionImpl.java:142)
	at org.springframework.orm.jpa.JpaTransactionManager.doRollback(JpaTransactionManager.java:589)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:897)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:866)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.completeTransactionAfterThrowing(TransactionAspectSupport.java:681)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:383)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.215760+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.getWarnings(JdbcConnection.java:646)
	at com.zaxxer.hikari.pool.HikariProxyConnection.getWarnings(HikariProxyConnection.java)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.handleAndClearWarnings(SqlExceptionHelper.java:298)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.logAndClearWarnings(SqlExceptionHelper.java:277)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.releaseConnection(LogicalConnectionManagedImpl.java:220)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.close(LogicalConnectionManagedImpl.java:258)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.close(JdbcCoordinatorImpl.java:161)
	at org.hibernate.internal.AbstractSharedSessionContract.close(AbstractSharedSessionContract.java:454)
	at org.hibernate.internal.SessionImpl.closeWithoutOpenChecks(SessionImpl.java:412)
	at org.hibernate.internal.SessionImpl.close(SessionImpl.java:394)
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.closeEntityManager(EntityManagerFactoryUtils.java:424)
	at org.springframework.orm.jpa.JpaTransactionManager.doCleanupAfterCompletion(JpaTransactionManager.java:654)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.cleanupAfterCompletion(AbstractPlatformTransactionManager.java:1062)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:943)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:866)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.completeTransactionAfterThrowing(TransactionAspectSupport.java:681)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:383)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.218763+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.clearWarnings(JdbcConnection.java:660)
	at com.zaxxer.hikari.pool.HikariProxyConnection.clearWarnings(HikariProxyConnection.java)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.handleAndClearWarnings(SqlExceptionHelper.java:307)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.logAndClearWarnings(SqlExceptionHelper.java:277)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.releaseConnection(LogicalConnectionManagedImpl.java:220)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.close(LogicalConnectionManagedImpl.java:258)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.close(JdbcCoordinatorImpl.java:161)
	at org.hibernate.internal.AbstractSharedSessionContract.close(AbstractSharedSessionContract.java:454)
	at org.hibernate.internal.SessionImpl.closeWithoutOpenChecks(SessionImpl.java:412)
	at org.hibernate.internal.SessionImpl.close(SessionImpl.java:394)
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.closeEntityManager(EntityManagerFactoryUtils.java:424)
	at org.springframework.orm.jpa.JpaTransactionManager.doCleanupAfterCompletion(JpaTransactionManager.java:654)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.cleanupAfterCompletion(AbstractPlatformTransactionManager.java:1062)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:943)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:866)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.completeTransactionAfterThrowing(TransactionAspectSupport.java:681)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:383)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.223763+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.rollback(JdbcConnection.java:511)
	at com.zaxxer.hikari.pool.ProxyConnection.close(ProxyConnection.java:250)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.closeConnection(DatasourceConnectionProviderImpl.java:127)
	at org.hibernate.internal.NonContextualJdbcConnectionAccess.releaseConnection(NonContextualJdbcConnectionAccess.java:64)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.releaseConnection(LogicalConnectionManagedImpl.java:224)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.close(LogicalConnectionManagedImpl.java:258)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.close(JdbcCoordinatorImpl.java:161)
	at org.hibernate.internal.AbstractSharedSessionContract.close(AbstractSharedSessionContract.java:454)
	at org.hibernate.internal.SessionImpl.closeWithoutOpenChecks(SessionImpl.java:412)
	at org.hibernate.internal.SessionImpl.close(SessionImpl.java:394)
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.closeEntityManager(EntityManagerFactoryUtils.java:424)
	at org.springframework.orm.jpa.JpaTransactionManager.doCleanupAfterCompletion(JpaTransactionManager.java:654)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.cleanupAfterCompletion(AbstractPlatformTransactionManager.java:1062)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:943)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:866)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.completeTransactionAfterThrowing(TransactionAspectSupport.java:681)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:383)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.518441+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.getAutoCommit(JdbcConnection.java:465)
	at com.zaxxer.hikari.pool.HikariProxyConnection.getAutoCommit(HikariProxyConnection.java)
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.determineInitialAutoCommitMode(AbstractLogicalConnectionImplementor.java:145)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.begin(LogicalConnectionManagedImpl.java:281)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.begin(JdbcResourceLocalTransactionCoordinatorImpl.java:232)
	at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:83)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.beginTransaction(HibernateJpaDialect.java:176)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:420)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:604)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:373)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.523730+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.setAutoCommit(JdbcConnection.java:437)
	at com.zaxxer.hikari.pool.ProxyConnection.setAutoCommit(ProxyConnection.java:402)
	at com.zaxxer.hikari.pool.HikariProxyConnection.setAutoCommit(HikariProxyConnection.java)
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.begin(AbstractLogicalConnectionImplementor.java:72)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.begin(LogicalConnectionManagedImpl.java:282)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.begin(JdbcResourceLocalTransactionCoordinatorImpl.java:232)
	at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:83)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.beginTransaction(HibernateJpaDialect.java:176)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:420)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:604)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:373)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.527731+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.getWarnings(JdbcConnection.java:646)
	at com.zaxxer.hikari.pool.HikariProxyConnection.getWarnings(HikariProxyConnection.java)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.handleAndClearWarnings(SqlExceptionHelper.java:298)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.logAndClearWarnings(SqlExceptionHelper.java:277)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.releaseConnection(LogicalConnectionManagedImpl.java:220)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.close(LogicalConnectionManagedImpl.java:258)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.close(JdbcCoordinatorImpl.java:161)
	at org.hibernate.internal.AbstractSharedSessionContract.close(AbstractSharedSessionContract.java:454)
	at org.hibernate.internal.SessionImpl.closeWithoutOpenChecks(SessionImpl.java:412)
	at org.hibernate.internal.SessionImpl.close(SessionImpl.java:394)
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.closeEntityManager(EntityManagerFactoryUtils.java:424)
	at org.springframework.orm.jpa.JpaTransactionManager.closeEntityManagerAfterFailedBegin(JpaTransactionManager.java:513)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:465)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:604)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:373)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.531815+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.clearWarnings(JdbcConnection.java:660)
	at com.zaxxer.hikari.pool.HikariProxyConnection.clearWarnings(HikariProxyConnection.java)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.handleAndClearWarnings(SqlExceptionHelper.java:307)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.logAndClearWarnings(SqlExceptionHelper.java:277)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.releaseConnection(LogicalConnectionManagedImpl.java:220)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.close(LogicalConnectionManagedImpl.java:258)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.close(JdbcCoordinatorImpl.java:161)
	at org.hibernate.internal.AbstractSharedSessionContract.close(AbstractSharedSessionContract.java:454)
	at org.hibernate.internal.SessionImpl.closeWithoutOpenChecks(SessionImpl.java:412)
	at org.hibernate.internal.SessionImpl.close(SessionImpl.java:394)
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.closeEntityManager(EntityManagerFactoryUtils.java:424)
	at org.springframework.orm.jpa.JpaTransactionManager.closeEntityManagerAfterFailedBegin(JpaTransactionManager.java:513)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:465)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:604)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:373)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:39:46.536047+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1425)
	at org.h2.jdbc.JdbcConnection.clearWarnings(JdbcConnection.java:660)
	at com.zaxxer.hikari.pool.ProxyConnection.close(ProxyConnection.java:258)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.closeConnection(DatasourceConnectionProviderImpl.java:127)
	at org.hibernate.internal.NonContextualJdbcConnectionAccess.releaseConnection(NonContextualJdbcConnectionAccess.java:64)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.releaseConnection(LogicalConnectionManagedImpl.java:224)
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.close(LogicalConnectionManagedImpl.java:258)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.close(JdbcCoordinatorImpl.java:161)
	at org.hibernate.internal.AbstractSharedSessionContract.close(AbstractSharedSessionContract.java:454)
	at org.hibernate.internal.SessionImpl.closeWithoutOpenChecks(SessionImpl.java:412)
	at org.hibernate.internal.SessionImpl.close(SessionImpl.java:394)
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.closeEntityManager(EntityManagerFactoryUtils.java:424)
	at org.springframework.orm.jpa.JpaTransactionManager.closeEntityManagerAfterFailedBegin(JpaTransactionManager.java:513)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:465)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:604)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:373)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy134.save(Unknown Source)
	at com.engine.ingest.strategy.impl.CustomerDataProcessor.processData(CustomerDataProcessor.java:23)
	at com.engine.ingest.strategy.DataProcessorFactory.executeStrategy(DataProcessorFactory.java:23)
	at com.engine.ingest.listener.IngestMessageListener.listen(IngestMessageListener.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:70)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:420)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:384)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2800)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2778)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.lambda$doInvokeRecordListener$53(KafkaMessageListenerContainer.java:2701)
	at io.micrometer.observation.Observation.observe(Observation.java:565)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2699)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2430)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2085)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1461)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1426)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1296)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:47:48.581388+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    YEAR(TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    MONTH(TRANSACTION_TIMESTAMP) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    YEAR(TRANSACTION_TIMESTAMP),\000d\000a    MONTH(TRANSACTION_TIMESTAMP)\000d\000aORDER BY \000d\000a    year, month"; expected "identifier"; SQL statement:
SELECT 
    YEAR(TRANSACTION_TIMESTAMP) AS year,
    MONTH(TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    YEAR(TRANSACTION_TIMESTAMP),
    MONTH(TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [42001-224]
2024-08-06 14:48:27.123343+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)\000d\000aORDER BY \000d\000a    year, month"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [42001-224]
2024-08-06 14:48:27.853735+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)\000d\000aORDER BY \000d\000a    year, month"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [42001-224]
2024-08-06 14:48:49.405488+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Function "DATEPART" not found; SQL statement:
SELECT 
    DATEPART('YEAR', TRANSACTION_TIMESTAMP) AS year,
    DATEPART('MONTH', TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    DATEPART('YEAR', TRANSACTION_TIMESTAMP),
    DATEPART('MONTH', TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [90022-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.readFunction(Parser.java:3786)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.parseSelectExpressions(Parser.java:2799)
	at org.h2.command.Parser.parseSelect(Parser.java:2817)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.parseQuery(Parser.java:2498)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:48:49.919295+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Function "DATEPART" not found; SQL statement:
SELECT 
    DATEPART('YEAR', TRANSACTION_TIMESTAMP) AS year,
    DATEPART('MONTH', TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    DATEPART('YEAR', TRANSACTION_TIMESTAMP),
    DATEPART('MONTH', TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [90022-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:644)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.readFunction(Parser.java:3786)
	at org.h2.command.Parser.readTermWithIdentifier(Parser.java:5148)
	at org.h2.command.Parser.readTerm(Parser.java:4834)
	at org.h2.command.Parser.readFactor(Parser.java:3337)
	at org.h2.command.Parser.readSum(Parser.java:3324)
	at org.h2.command.Parser.readConcat(Parser.java:3289)
	at org.h2.command.Parser.readCondition(Parser.java:3079)
	at org.h2.command.Parser.readExpression(Parser.java:2999)
	at org.h2.command.Parser.parseSelectExpressions(Parser.java:2799)
	at org.h2.command.Parser.parseSelect(Parser.java:2817)
	at org.h2.command.Parser.parseQueryPrimary(Parser.java:2708)
	at org.h2.command.Parser.parseQueryTerm(Parser.java:2564)
	at org.h2.command.Parser.parseQueryExpressionBody(Parser.java:2543)
	at org.h2.command.Parser.parseQueryExpressionBodyAndEndOfQuery(Parser.java:2536)
	at org.h2.command.Parser.parseQueryExpression(Parser.java:2529)
	at org.h2.command.Parser.parseQuery(Parser.java:2498)
	at org.h2.command.Parser.parsePrepared(Parser.java:627)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1345)
	at org.h2.server.web.WebApp.query(WebApp.java:1143)
	at org.h2.server.web.WebApp.query(WebApp.java:1119)
	at org.h2.server.web.WebApp.process(WebApp.java:245)
	at org.h2.server.web.WebApp.processRequest(WebApp.java:177)
	at org.h2.server.web.JakartaWebServlet.doGet(JakartaWebServlet.java:129)
	at org.h2.server.web.JakartaWebServlet.doPost(JakartaWebServlet.java:166)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:389)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2024-08-06 14:49:16.854515+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year,\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)\000d\000aORDER BY \000d\000a    year, month"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year,
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)
ORDER BY 
    year, month [42001-224]
2024-08-06 14:49:17.390838+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year,\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)\000d\000aORDER BY \000d\000a    year, month"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year,
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)
ORDER BY 
    year, month [42001-224]
2024-08-06 14:49:31.513399+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year,\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year,
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) [42001-224]
2024-08-06 14:49:32.008768+04:00 jdbc[14]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year,\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year,
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) [42001-224]
2024-08-06 14:50:16.124845+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year,\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year,
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) [42001-224]
2024-08-06 14:50:40.154101+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year,\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year,
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) [42001-224]
2024-08-06 14:50:40.708569+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year,\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),\000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2)"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year,
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4),
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 6, 2) [42001-224]
2024-08-06 14:50:50.183100+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:50:50.704794+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS [*]year\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
    SUBSTRING(CAST(TRANSACTION_TIMESTAMP AS VARCHAR), 1, 4) AS year
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:50:59.623772+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    YEAR(TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    MONTH(TRANSACTION_TIMESTAMP) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
    YEAR(TRANSACTION_TIMESTAMP) AS year,
    MONTH(TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:51:00.153761+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    YEAR(TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    MONTH(TRANSACTION_TIMESTAMP) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
    YEAR(TRANSACTION_TIMESTAMP) AS year,
    MONTH(TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:52:45.660126+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    YEAR(TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    MONTH(TRANSACTION_TIMESTAMP) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000a\000d\000aSELECT * FROM SALES_TRANSACTIONSWHERE FORMATDATETIME(TRANSACTION_TIMESTAMP,'yyyy-MM-dd') = '2018-11-28'\000d\000a\000d\000a\000d\000aSELECT EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) FROM SALES_TRANSACTIONSNAME"; expected "identifier"; SQL statement:
SELECT 
    YEAR(TRANSACTION_TIMESTAMP) AS year,
    MONTH(TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS

SELECT * FROM SALES_TRANSACTIONSWHERE FORMATDATETIME(TRANSACTION_TIMESTAMP,'yyyy-MM-dd') = '2018-11-28'


SELECT EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) FROM SALES_TRANSACTIONSNAME [42001-224]
2024-08-06 14:52:47.863798+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "SALES_TRANSACTIONSNAME" not found; SQL statement:
SELECT EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) FROM SALES_TRANSACTIONSNAME [42102-224]
2024-08-06 14:52:48.683321+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "SALES_TRANSACTIONSNAME" not found; SQL statement:
SELECT EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) FROM SALES_TRANSACTIONSNAME [42102-224]
2024-08-06 14:53:39.429294+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)\000d\000aORDER BY \000d\000a    year, month"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [42001-224]
2024-08-06 14:53:40.459071+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)\000d\000aORDER BY \000d\000a    year, month"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [42001-224]
2024-08-06 14:54:05.562556+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000a   *\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
   *
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:54:21.760042+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000a    s.*\000d\000aFROM \000d\000a    SALES_TRANSACTIONS s"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
    s.*
FROM 
    SALES_TRANSACTIONS s [42001-224]
2024-08-06 14:54:22.347180+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000a    s.*\000d\000aFROM \000d\000a    SALES_TRANSACTIONS s"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
    s.*
FROM 
    SALES_TRANSACTIONS s [42001-224]
2024-08-06 14:54:27.307728+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000aFROM \000d\000a    SALES_TRANSACTIONS s"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
FROM 
    SALES_TRANSACTIONS s [42001-224]
2024-08-06 14:54:35.190681+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:54:35.756738+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS [*]year,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS year,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS month,
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:56:15.570014+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a   EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP)  as [*]year\000d\000a   EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) as month\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
   EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP)  as year
   EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) as month
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:56:20.436442+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a   EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP)  as [*]year,\000d\000a   EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) as month\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
   EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP)  as year,
   EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) as month
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:56:21.302074+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a   EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP)  as [*]year,\000d\000a   EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) as month\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
   EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP)  as year,
   EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) as month
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:56:43.684537+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a   EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP)  as [*]YEAR,\000d\000a   EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) as M\000d\000aFROM \000d\000a    SALES_TRANSACTIONS"; expected "identifier"; SQL statement:
SELECT 
   EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP)  as YEAR,
   EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) as M
FROM 
    SALES_TRANSACTIONS [42001-224]
2024-08-06 14:56:58.071359+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS Y,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS M,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)\000d\000aORDER BY \000d\000a    year[*], month"; expected "("; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS Y,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS M,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [42001-224]
2024-08-06 14:56:58.953218+04:00 jdbc[15]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "SELECT \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS Y,\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS M,\000d\000a    COUNT(*) AS salesCount\000d\000aFROM \000d\000a    SALES_TRANSACTIONS\000d\000aGROUP BY \000d\000a    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),\000d\000a    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)\000d\000aORDER BY \000d\000a    year[*], month"; expected "("; SQL statement:
SELECT 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) AS Y,
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) AS M,
    COUNT(*) AS salesCount
FROM 
    SALES_TRANSACTIONS
GROUP BY 
    EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP),
    EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP)
ORDER BY 
    year, month [42001-224]
2024-08-06 15:04:03.703551+04:00 database: flush
org.h2.message.DbException: General error: "org.h2.mvstore.MVStoreException: java.lang.AssertionError: 73728 != 69632 [2.2.224/3]" [50000-224]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:407)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:122)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:1546)
	at org.h2.mvstore.MVStore.panic(MVStore.java:371)
	at org.h2.mvstore.FileStore.storeBuffer(FileStore.java:1529)
	at org.h2.mvstore.FileStore.lambda$serializeAndStore$3(FileStore.java:1432)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: General error: "org.h2.mvstore.MVStoreException: java.lang.AssertionError: 73728 != 69632 [2.2.224/3]" [50000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:566)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	... 12 more
Caused by: org.h2.mvstore.MVStoreException: java.lang.AssertionError: 73728 != 69632 [2.2.224/3]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	... 7 more
Caused by: java.lang.AssertionError: 73728 != 69632
	at org.h2.mvstore.RandomAccessStore.shrinkStoreIfPossible(RandomAccessStore.java:679)
	at org.h2.mvstore.RandomAccessStore.writeChunk(RandomAccessStore.java:377)
	at org.h2.mvstore.RandomAccessStore.writeChunk(RandomAccessStore.java:28)
	at org.h2.mvstore.FileStore.storeBuffer(FileStore.java:1524)
	... 6 more
2024-08-06 15:04:03.740832+04:00 jdbc[12]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: The database has been closed [90098-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.engine.SessionLocal.getTransaction(SessionLocal.java:1610)
	at org.h2.engine.SessionLocal.startStatementWithinTransaction(SessionLocal.java:1631)
	at org.h2.command.Command.executeQuery(Command.java:186)
	at org.h2.jdbc.JdbcConnection.isReadOnly(JdbcConnection.java:588)
	at com.zaxxer.hikari.pool.PoolBase.setupConnection(PoolBase.java:404)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:365)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:202)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:461)
	at com.zaxxer.hikari.pool.HikariPool$PoolEntryCreator.call(HikariPool.java:724)
	at com.zaxxer.hikari.pool.HikariPool$PoolEntryCreator.call(HikariPool.java:703)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.h2.mvstore.MVStoreException: java.lang.AssertionError: 73728 != 69632 [2.2.224/3]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.FileStore.storeBuffer(FileStore.java:1529)
	at org.h2.mvstore.FileStore.lambda$serializeAndStore$3(FileStore.java:1432)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	... 4 more
Caused by: java.lang.AssertionError: 73728 != 69632
	at org.h2.mvstore.RandomAccessStore.shrinkStoreIfPossible(RandomAccessStore.java:679)
	at org.h2.mvstore.RandomAccessStore.writeChunk(RandomAccessStore.java:377)
	at org.h2.mvstore.RandomAccessStore.writeChunk(RandomAccessStore.java:28)
	at org.h2.mvstore.FileStore.storeBuffer(FileStore.java:1524)
	... 6 more
2024-08-06 15:04:04.464732+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: The database has been closed [90098-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.engine.SessionLocal.getTransaction(SessionLocal.java:1610)
	at org.h2.engine.SessionLocal.startStatementWithinTransaction(SessionLocal.java:1631)
	at org.h2.command.Command.executeQuery(Command.java:186)
	at org.h2.jdbc.JdbcConnection.getCatalog(JdbcConnection.java:626)
	at com.zaxxer.hikari.pool.HikariProxyConnection.getCatalog(HikariProxyConnection.java)
	at org.hibernate.engine.jdbc.env.internal.ExtractedDatabaseMetaDataImpl$Builder.apply(ExtractedDatabaseMetaDataImpl.java:190)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentImpl.<init>(JdbcEnvironmentImpl.java:292)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$1.execute(JdbcEnvironmentInitiator.java:323)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$1.execute(JdbcEnvironmentInitiator.java:291)
	at org.hibernate.jdbc.WorkExecutor.executeReturningWork(WorkExecutor.java:58)
	at org.hibernate.jdbc.AbstractReturningWork.accept(AbstractReturningWork.java:34)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:70)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:290)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:123)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:77)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:130)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:221)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:189)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:171)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1431)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1502)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1853)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1802)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:205)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:954)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:625)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:137)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46)
	at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1463)
	at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:553)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:137)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:108)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:225)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:152)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130)
	at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:191)
	at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:130)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260)
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:163)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$10(ClassBasedTestDescriptor.java:378)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:310)
	at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735)
	at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:734)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$6(ClassBasedTestDescriptor.java:290)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$4(ClassBasedTestDescriptor.java:279)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:278)
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$0(TestMethodTestDescriptor.java:106)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:105)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:90)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
Caused by: org.h2.mvstore.MVStoreException: java.lang.AssertionError: 73728 != 69632 [2.2.224/3]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.FileStore.storeBuffer(FileStore.java:1529)
	at org.h2.mvstore.FileStore.lambda$serializeAndStore$3(FileStore.java:1432)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.AssertionError: 73728 != 69632
	at org.h2.mvstore.RandomAccessStore.shrinkStoreIfPossible(RandomAccessStore.java:679)
	at org.h2.mvstore.RandomAccessStore.writeChunk(RandomAccessStore.java:377)
	at org.h2.mvstore.RandomAccessStore.writeChunk(RandomAccessStore.java:28)
	at org.h2.mvstore.FileStore.storeBuffer(FileStore.java:1524)
	... 6 more
2024-08-06 15:04:05.514228+04:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLNonTransientConnectionException: The database has been closed [90098-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:690)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.engine.SessionLocal.getTransaction(SessionLocal.java:1610)
	at org.h2.engine.SessionLocal.startStatementWithinTransaction(SessionLocal.java:1631)
	at org.h2.command.Command.executeQuery(Command.java:186)
	at org.h2.jdbc.JdbcPreparedStatement.executeQuery(JdbcPreparedStatement.java:131)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.tool.schema.extract.spi.ExtractionContext.getQueryResults(ExtractionContext.java:49)
	at org.hibernate.tool.schema.extract.internal.SequenceInformationExtractorLegacyImpl.extractMetadata(SequenceInformationExtractorLegacyImpl.java:39)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.initializeSequences(DatabaseInformationImpl.java:66)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.<init>(DatabaseInformationImpl.java:60)
	at org.hibernate.tool.schema.internal.Helper.buildDatabaseInformation(Helper.java:185)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:98)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1421)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:322)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:457)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1506)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1853)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1802)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:205)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:954)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:625)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:137)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46)
	at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1463)
	at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:553)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:137)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:108)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:225)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:152)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130)
	at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:191)
	at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:130)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260)
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:163)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$10(ClassBasedTestDescriptor.java:378)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:310)
	at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735)
	at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:734)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$6(ClassBasedTestDescriptor.java:290)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$4(ClassBasedTestDescriptor.java:279)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:278)
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$0(TestMethodTestDescriptor.java:106)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:105)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:90)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
Caused by: org.h2.mvstore.MVStoreException: java.lang.AssertionError: 73728 != 69632 [2.2.224/3]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:996)
	at org.h2.mvstore.FileStore.storeBuffer(FileStore.java:1529)
	at org.h2.mvstore.FileStore.lambda$serializeAndStore$3(FileStore.java:1432)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.lang.AssertionError: 73728 != 69632
	at org.h2.mvstore.RandomAccessStore.shrinkStoreIfPossible(RandomAccessStore.java:679)
	at org.h2.mvstore.RandomAccessStore.writeChunk(RandomAccessStore.java:377)
	at org.h2.mvstore.RandomAccessStore.writeChunk(RandomAccessStore.java:28)
	at org.h2.mvstore.FileStore.storeBuffer(FileStore.java:1524)
	... 6 more
